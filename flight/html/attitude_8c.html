<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>dRonin: flight/Modules/Attitude/attitude.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon_128x128.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">dRonin
   &#160;<span id="projectnumber">1b4ea27</span>
   </div>
   <div id="projectbrief">dRonin&nbsp;firmware</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('attitude_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">attitude.c File Reference<div class="ingroups"><a class="el" href="group___attitude_module.html">Attitude and state estimation module</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Full attitude estimation algorithm.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;openpilot.h&quot;</code><br/>
<code>#include &quot;pios.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="pios__thread_8h_source.html">pios_thread.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="pios__queue_8h_source.html">pios_queue.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="misc__math_8h_source.html">misc_math.h</a>&quot;</code><br/>
<code>#include &quot;physical_constants.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="coordinate__conversions_8h_source.html">coordinate_conversions.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="_world_mag_model_8h_source.html">WorldMagModel.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="insgps_8h_source.html">insgps.h</a>&quot;</code><br/>
<code>#include &quot;accels.h&quot;</code><br/>
<code>#include &quot;attitudeactual.h&quot;</code><br/>
<code>#include &quot;attitudesettings.h&quot;</code><br/>
<code>#include &quot;baroaltitude.h&quot;</code><br/>
<code>#include &quot;flightstatus.h&quot;</code><br/>
<code>#include &quot;gpsposition.h&quot;</code><br/>
<code>#include &quot;gpstime.h&quot;</code><br/>
<code>#include &quot;gpsvelocity.h&quot;</code><br/>
<code>#include &quot;gyros.h&quot;</code><br/>
<code>#include &quot;gyrosbias.h&quot;</code><br/>
<code>#include &quot;homelocation.h&quot;</code><br/>
<code>#include &quot;sensorsettings.h&quot;</code><br/>
<code>#include &quot;inssettings.h&quot;</code><br/>
<code>#include &quot;insstate.h&quot;</code><br/>
<code>#include &quot;magnetometer.h&quot;</code><br/>
<code>#include &quot;nedaccel.h&quot;</code><br/>
<code>#include &quot;nedposition.h&quot;</code><br/>
<code>#include &quot;positionactual.h&quot;</code><br/>
<code>#include &quot;stateestimation.h&quot;</code><br/>
<code>#include &quot;systemalarms.h&quot;</code><br/>
<code>#include &quot;velocityactual.h&quot;</code><br/>
</div>
<p><a href="attitude_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcomplementary__filter__state.html">complementary_filter_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfvert.html">cfvert</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struture that tracks the data for the vertical complementary filter.  <a href="structcfvert.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga8ba6b61bd4ff2677b6d5f6be4c5d8725"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga8ba6b61bd4ff2677b6d5f6be4c5d8725">STACK_SIZE_BYTES</a>&#160;&#160;&#160;2504</td></tr>
<tr class="separator:ga8ba6b61bd4ff2677b6d5f6be4c5d8725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82dd0a9ae27bdb2c3cdd33bb7804861c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga82dd0a9ae27bdb2c3cdd33bb7804861c">TASK_PRIORITY</a>&#160;&#160;&#160;<a class="el" href="group___p_i_o_s___thread.html#ggaaf67f9ea6e212bc198f6d4302ea21e54abbe1aff2d1bfe2d5c2aeae36e422909d">PIOS_THREAD_PRIO_HIGH</a></td></tr>
<tr class="separator:ga82dd0a9ae27bdb2c3cdd33bb7804861c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50858e76836ece0d48f2f319744d5c7c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga50858e76836ece0d48f2f319744d5c7c">FAILSAFE_TIMEOUT_MS</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ga50858e76836ece0d48f2f319744d5c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga2a3dfab57b52ff023f9197d9afe06ff4"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga2a3dfab57b52ff023f9197d9afe06ff4">complementary_filter_status</a> { <a class="el" href="group___attitude_module.html#gga2a3dfab57b52ff023f9197d9afe06ff4a1b205074eafd92be8fbb945482e2c5c2">CF_POWERON</a>, 
<a class="el" href="group___attitude_module.html#gga2a3dfab57b52ff023f9197d9afe06ff4aee904149480808a1828f1e546b365411">CF_INITIALIZING</a>, 
<a class="el" href="group___attitude_module.html#gga2a3dfab57b52ff023f9197d9afe06ff4aaeeddedb486c25be85918925490e4f7c">CF_ARMING</a>, 
<a class="el" href="group___attitude_module.html#gga2a3dfab57b52ff023f9197d9afe06ff4acfd7a1440ea5820f0b90b2943586a542">CF_NORMAL</a>
 }</td></tr>
<tr class="separator:ga2a3dfab57b52ff023f9197d9afe06ff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5b9ca9b050dc607b1927cd4852ca9c6f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga5b9ca9b050dc607b1927cd4852ca9c6f">AttitudeTask</a> (void *parameters)</td></tr>
<tr class="separator:ga5b9ca9b050dc607b1927cd4852ca9c6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6604331f3424247baba9350e067288e6"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga6604331f3424247baba9350e067288e6">setNavigationRaw</a> ()</td></tr>
<tr class="memdesc:ga6604331f3424247baba9350e067288e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the navigation information to the raw estimates.  <a href="group___attitude_module.html#ga6604331f3424247baba9350e067288e6">More...</a><br/></td></tr>
<tr class="separator:ga6604331f3424247baba9350e067288e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ef260a856c3edf49810a55a5f1ac167"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga9ef260a856c3edf49810a55a5f1ac167">setNavigationNone</a> ()</td></tr>
<tr class="memdesc:ga9ef260a856c3edf49810a55a5f1ac167"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide no navigation updates (indoor flying or without gps)  <a href="group___attitude_module.html#ga9ef260a856c3edf49810a55a5f1ac167">More...</a><br/></td></tr>
<tr class="separator:ga9ef260a856c3edf49810a55a5f1ac167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13a4c91692dac51e1ccb8d460c09dbc3"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga13a4c91692dac51e1ccb8d460c09dbc3">updateAttitudeComplementary</a> (float dT, bool first_run, bool secondary, bool raw_gps)</td></tr>
<tr class="memdesc:ga13a4c91692dac51e1ccb8d460c09dbc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the complementary filter attitude estimate.  <a href="group___attitude_module.html#ga13a4c91692dac51e1ccb8d460c09dbc3">More...</a><br/></td></tr>
<tr class="separator:ga13a4c91692dac51e1ccb8d460c09dbc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f38d1edf9d67d8a8917be9b132a1650"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga0f38d1edf9d67d8a8917be9b132a1650">setAttitudeComplementary</a> ()</td></tr>
<tr class="memdesc:ga0f38d1edf9d67d8a8917be9b132a1650"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the AttitudeActual to the complementary filter estimate.  <a href="group___attitude_module.html#ga0f38d1edf9d67d8a8917be9b132a1650">More...</a><br/></td></tr>
<tr class="separator:ga0f38d1edf9d67d8a8917be9b132a1650"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac8d5761247c84c64dddb7be876792913"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gac8d5761247c84c64dddb7be876792913">calc_ned_accel</a> (float *q, float *accels)</td></tr>
<tr class="separator:gac8d5761247c84c64dddb7be876792913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafd957020bc37a03983ab93527452020b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gafd957020bc37a03983ab93527452020b">cfvert_reset</a> (struct <a class="el" href="structcfvert.html">cfvert</a> *cf, float baro, float time_constant)</td></tr>
<tr class="memdesc:gafd957020bc37a03983ab93527452020b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the vertical baro complementary filter and zeros the altitude.  <a href="group___attitude_module.html#gafd957020bc37a03983ab93527452020b">More...</a><br/></td></tr>
<tr class="separator:gafd957020bc37a03983ab93527452020b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9535ff3996e56471e7f3248a10c44038"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga9535ff3996e56471e7f3248a10c44038">cfvert_predict_pos</a> (struct <a class="el" href="structcfvert.html">cfvert</a> *cf, float z_accel, float dt)</td></tr>
<tr class="memdesc:ga9535ff3996e56471e7f3248a10c44038"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict the position in the future.  <a href="group___attitude_module.html#ga9535ff3996e56471e7f3248a10c44038">More...</a><br/></td></tr>
<tr class="separator:ga9535ff3996e56471e7f3248a10c44038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81b931361fcb4f10bde85a5623b411e0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga81b931361fcb4f10bde85a5623b411e0">cfvert_update_baro</a> (struct <a class="el" href="structcfvert.html">cfvert</a> *cf, float baro, float dt)</td></tr>
<tr class="memdesc:ga81b931361fcb4f10bde85a5623b411e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the baro feedback.  <a href="group___attitude_module.html#ga81b931361fcb4f10bde85a5623b411e0">More...</a><br/></td></tr>
<tr class="separator:ga81b931361fcb4f10bde85a5623b411e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad63d3cf62c303f66aea711afbdc6edba"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gad63d3cf62c303f66aea711afbdc6edba">updateAttitudeINSGPS</a> (bool first_run, bool outdoor_mode)</td></tr>
<tr class="memdesc:gad63d3cf62c303f66aea711afbdc6edba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the INSGPS attitude estimate.  <a href="group___attitude_module.html#gad63d3cf62c303f66aea711afbdc6edba">More...</a><br/></td></tr>
<tr class="separator:gad63d3cf62c303f66aea711afbdc6edba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66df2c3d3d4fab88b927def00ea1a7f0"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga66df2c3d3d4fab88b927def00ea1a7f0">setAttitudeINSGPS</a> ()</td></tr>
<tr class="memdesc:ga66df2c3d3d4fab88b927def00ea1a7f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the attitude to the current INSGPS estimate.  <a href="group___attitude_module.html#ga66df2c3d3d4fab88b927def00ea1a7f0">More...</a><br/></td></tr>
<tr class="separator:ga66df2c3d3d4fab88b927def00ea1a7f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf7bd85556060be5c23393d3243956df5"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gaf7bd85556060be5c23393d3243956df5">setNavigationINSGPS</a> ()</td></tr>
<tr class="memdesc:gaf7bd85556060be5c23393d3243956df5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the navigation to the current INSGPS estimate.  <a href="group___attitude_module.html#gaf7bd85556060be5c23393d3243956df5">More...</a><br/></td></tr>
<tr class="separator:gaf7bd85556060be5c23393d3243956df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5de0a7ca8bf423e9f7ada9c3da1ac34e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga5de0a7ca8bf423e9f7ada9c3da1ac34e">updateNedAccel</a> ()</td></tr>
<tr class="separator:ga5de0a7ca8bf423e9f7ada9c3da1ac34e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf179d2bdeba73684f425664481b78b7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gaaf179d2bdeba73684f425664481b78b7">apply_accel_filter</a> (const float *raw, float *filtered)</td></tr>
<tr class="memdesc:gaaf179d2bdeba73684f425664481b78b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">A low pass filter on the accels which helps with vibration resistance.  <a href="group___attitude_module.html#gaaf179d2bdeba73684f425664481b78b7">More...</a><br/></td></tr>
<tr class="separator:gaaf179d2bdeba73684f425664481b78b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa56401136ce036bf887c06f80ea67c09"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gaa56401136ce036bf887c06f80ea67c09">getNED</a> (GPSPositionData *gpsPosition, float *NED)</td></tr>
<tr class="memdesc:gaa56401136ce036bf887c06f80ea67c09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert the GPS LLA position into NED coordinates.  <a href="group___attitude_module.html#gaa56401136ce036bf887c06f80ea67c09">More...</a><br/></td></tr>
<tr class="separator:gaa56401136ce036bf887c06f80ea67c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga495f3b515a8ba755fdce36d7ec488b1c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga495f3b515a8ba755fdce36d7ec488b1c">accumulate_gyro_compute</a> ()</td></tr>
<tr class="memdesc:ga495f3b515a8ba755fdce36d7ec488b1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the mean gyro accumulated and assign the bias.  <a href="group___attitude_module.html#ga495f3b515a8ba755fdce36d7ec488b1c">More...</a><br/></td></tr>
<tr class="separator:ga495f3b515a8ba755fdce36d7ec488b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa5f9a078fc70b1ba078054b1b947176f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gaa5f9a078fc70b1ba078054b1b947176f">accumulate_gyro_zero</a> ()</td></tr>
<tr class="memdesc:gaa5f9a078fc70b1ba078054b1b947176f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zero the gyro accumulators.  <a href="group___attitude_module.html#gaa5f9a078fc70b1ba078054b1b947176f">More...</a><br/></td></tr>
<tr class="separator:gaa5f9a078fc70b1ba078054b1b947176f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga110cb32a4a23d36089aab39fd9101e9e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga110cb32a4a23d36089aab39fd9101e9e">accumulate_gyro</a> (GyrosData *gyrosData)</td></tr>
<tr class="memdesc:ga110cb32a4a23d36089aab39fd9101e9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store a gyro sample.  <a href="group___attitude_module.html#ga110cb32a4a23d36089aab39fd9101e9e">More...</a><br/></td></tr>
<tr class="separator:ga110cb32a4a23d36089aab39fd9101e9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4517c449f07800794cef0ccfd7631156"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga4517c449f07800794cef0ccfd7631156">set_state_estimation_error</a> (SystemAlarmsStateEstimationOptions error_code)</td></tr>
<tr class="memdesc:ga4517c449f07800794cef0ccfd7631156"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set alarm and alarm code.  <a href="group___attitude_module.html#ga4517c449f07800794cef0ccfd7631156">More...</a><br/></td></tr>
<tr class="separator:ga4517c449f07800794cef0ccfd7631156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga822997c683cd93901d24a78b838be731"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga822997c683cd93901d24a78b838be731">check_home_location</a> ()</td></tr>
<tr class="memdesc:ga822997c683cd93901d24a78b838be731"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if it is safe to set the home location then do it.  <a href="group___attitude_module.html#ga822997c683cd93901d24a78b838be731">More...</a><br/></td></tr>
<tr class="separator:ga822997c683cd93901d24a78b838be731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab3e9047ab7c9b02bd61091a4a2e8f572"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gab3e9047ab7c9b02bd61091a4a2e8f572">AttitudeInitialize</a> (void)</td></tr>
<tr class="separator:gab3e9047ab7c9b02bd61091a4a2e8f572"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa0dba388f0dec215cb7cbe55ad0356b"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gaaa0dba388f0dec215cb7cbe55ad0356b">AttitudeStart</a> (void)</td></tr>
<tr class="separator:gaaa0dba388f0dec215cb7cbe55ad0356b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga482eb3758803d8b9cafef7a51060f34c"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structpios__thread.html">pios_thread</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga482eb3758803d8b9cafef7a51060f34c">attitudeTaskHandle</a></td></tr>
<tr class="separator:ga482eb3758803d8b9cafef7a51060f34c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacdbe196fd5d94792983e85c67172e844"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structpios__queue.html">pios_queue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gacdbe196fd5d94792983e85c67172e844">gyroQueue</a></td></tr>
<tr class="separator:gacdbe196fd5d94792983e85c67172e844"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9c4c234ed6af063a0caa20cb45519411"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structpios__queue.html">pios_queue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga9c4c234ed6af063a0caa20cb45519411">accelQueue</a></td></tr>
<tr class="separator:ga9c4c234ed6af063a0caa20cb45519411"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga26a8440c224690e7de90dac94b9d0761"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structpios__queue.html">pios_queue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga26a8440c224690e7de90dac94b9d0761">magQueue</a></td></tr>
<tr class="separator:ga26a8440c224690e7de90dac94b9d0761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga57e0e91b9579346b0e90e60b3821972f"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structpios__queue.html">pios_queue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga57e0e91b9579346b0e90e60b3821972f">baroQueue</a></td></tr>
<tr class="separator:ga57e0e91b9579346b0e90e60b3821972f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga21f485db66f0826599238a79b756d805"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structpios__queue.html">pios_queue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga21f485db66f0826599238a79b756d805">gpsQueue</a></td></tr>
<tr class="separator:ga21f485db66f0826599238a79b756d805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5016167649a7652f46a11d3739daf3fe"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structpios__queue.html">pios_queue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga5016167649a7652f46a11d3739daf3fe">gpsVelQueue</a></td></tr>
<tr class="separator:ga5016167649a7652f46a11d3739daf3fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f6543ab52bafea6c0858baeeae8db59"><td class="memItemLeft" align="right" valign="top">static AttitudeSettingsData&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga8f6543ab52bafea6c0858baeeae8db59">attitudeSettings</a></td></tr>
<tr class="separator:ga8f6543ab52bafea6c0858baeeae8db59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2df5dd1b897f5b24779f6e0ad9b5b119"><td class="memItemLeft" align="right" valign="top">static HomeLocationData&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga2df5dd1b897f5b24779f6e0ad9b5b119">homeLocation</a></td></tr>
<tr class="separator:ga2df5dd1b897f5b24779f6e0ad9b5b119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab91f2e4b019b6c71d6047e2f06bdf30d"><td class="memItemLeft" align="right" valign="top">static INSSettingsData&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gab91f2e4b019b6c71d6047e2f06bdf30d">insSettings</a></td></tr>
<tr class="separator:gab91f2e4b019b6c71d6047e2f06bdf30d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6284b520eced53bee05e93510e93a5e5"><td class="memItemLeft" align="right" valign="top">static StateEstimationData&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga6284b520eced53bee05e93510e93a5e5">stateEstimation</a></td></tr>
<tr class="separator:ga6284b520eced53bee05e93510e93a5e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga379867b8ed4f0941018f1b0cc81d0b7b"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga379867b8ed4f0941018f1b0cc81d0b7b">gyroBiasSettingsUpdated</a> = false</td></tr>
<tr class="separator:ga379867b8ed4f0941018f1b0cc81d0b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac0da75e77e4e4f4b1e6c1fb6de575f65"><td class="memItemLeft" align="right" valign="top">static volatile bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gac0da75e77e4e4f4b1e6c1fb6de575f65">settings_flag</a> = true</td></tr>
<tr class="separator:gac0da75e77e4e4f4b1e6c1fb6de575f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae10ba1c8efb9a734635be19bd1718524"><td class="memItemLeft" align="right" valign="top">static volatile bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gae10ba1c8efb9a734635be19bd1718524">homeloc_flag</a> = true</td></tr>
<tr class="separator:gae10ba1c8efb9a734635be19bd1718524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaec583b104271db57b9b3c06df822320d"><td class="memItemLeft" align="right" valign="top">static volatile bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gaec583b104271db57b9b3c06df822320d">sensors_flag</a> = true</td></tr>
<tr class="separator:gaec583b104271db57b9b3c06df822320d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa1f97633cb6de4952c4e2fb3aa8c16b4"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gaa1f97633cb6de4952c4e2fb3aa8c16b4">home_location_updated</a></td></tr>
<tr class="separator:gaa1f97633cb6de4952c4e2fb3aa8c16b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5156866e209e6b8439a9165110f194f8"><td class="memItemLeft" align="right" valign="top">static const float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga5156866e209e6b8439a9165110f194f8">zeros</a> [3] = {0.0f, 0.0f, 0.0f}</td></tr>
<tr class="separator:ga5156866e209e6b8439a9165110f194f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf40b54ff53647c74794f31530552529e"><td class="memItemLeft" align="right" valign="top">static struct <br class="typebreak"/>
<a class="el" href="structcomplementary__filter__state.html">complementary_filter_state</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#gaf40b54ff53647c74794f31530552529e">complementary_filter_state</a></td></tr>
<tr class="separator:gaf40b54ff53647c74794f31530552529e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2ee5363877eb71d03d0bf0d2effc3d03"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structcfvert.html">cfvert</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga2ee5363877eb71d03d0bf0d2effc3d03">cfvert</a></td></tr>
<tr class="memdesc:ga2ee5363877eb71d03d0bf0d2effc3d03"><td class="mdescLeft">&#160;</td><td class="mdescRight">State information for vertical filter.  <a href="group___attitude_module.html#ga2ee5363877eb71d03d0bf0d2effc3d03">More...</a><br/></td></tr>
<tr class="separator:ga2ee5363877eb71d03d0bf0d2effc3d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50463f9755fec2828ef442d6d3b20e6c"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga50463f9755fec2828ef442d6d3b20e6c">dT_expected</a> = 0.001f</td></tr>
<tr class="separator:ga50463f9755fec2828ef442d6d3b20e6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga62b409271acba166dbf31b4fed9af697"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga62b409271acba166dbf31b4fed9af697">T</a> [3]</td></tr>
<tr class="memdesc:ga62b409271acba166dbf31b4fed9af697"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scales used in NED transform (local tangent plane approx).  <a href="group___attitude_module.html#ga62b409271acba166dbf31b4fed9af697">More...</a><br/></td></tr>
<tr class="separator:ga62b409271acba166dbf31b4fed9af697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6d40820c42d6849384d5ca19808e58a9"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___attitude_module.html#ga6d40820c42d6849384d5ca19808e58a9">cf_q</a> [4]</td></tr>
<tr class="memdesc:ga6d40820c42d6849384d5ca19808e58a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The complementary filter attitude estimate.  <a href="group___attitude_module.html#ga6d40820c42d6849384d5ca19808e58a9">More...</a><br/></td></tr>
<tr class="separator:ga6d40820c42d6849384d5ca19808e58a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Full attitude estimation algorithm. </p>
<dl class="section author"><dt>Author</dt><dd>The OpenPilot Team, <a href="http://www.openpilot.org">http://www.openpilot.org</a> Copyright (C) 2010. </dd>
<dd>
Tau Labs, <a href="http://taulabs.org">http://taulabs.org</a> Copyright (C) 2012-2016 </dd>
<dd>
dRonin, <a href="http://dronin.org">http://dronin.org</a> Copyright (C) 2015-2017 </dd></dl>
<dl class="section see"><dt>See Also</dt><dd>The GNU Public License (GPL) Version 3 </dd></dl>

<p>Definition in file <a class="el" href="attitude_8c_source.html">attitude.c</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_aa98a92d0ee4a874a8da6d1a4d95ab49.html">flight</a></li><li class="navelem"><a class="el" href="dir_84cbccaa40138d521c3102dda2be2c75.html">Modules</a></li><li class="navelem"><a class="el" href="dir_9130b27fd95349d49326874151611ab5.html">Attitude</a></li><li class="navelem"><a class="el" href="attitude_8c.html">attitude.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
