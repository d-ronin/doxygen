<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>dRonin: ground/gcs/src/plugins/uploader/uploadergadgetwidget.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon_128x128.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">dRonin
   &#160;<span id="projectnumber">cd7a75d</span>
   </div>
   <div id="projectbrief">dRonin&nbsp;GCS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('uploadergadgetwidget_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">uploadergadgetwidget.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="uploadergadgetwidget_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * the Free Software Foundation; either version 3 of the License, or</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * (at your option) any later version.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful, but</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * for more details.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License along</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * Additional note on redistribution: The copyright and license notices above</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * must be maintained in each individual source file that is a derivative work</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * of this source file; otherwise redistribution is prohibited.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;QFileDialog&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;QMessageBox&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;QDesktopServices&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;QHttpPart&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;QHttpMultiPart&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;QNetworkAccessManager&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;QNetworkRequest&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;QNetworkReply&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;QUrl&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="uploadergadgetwidget_8h.html">uploadergadgetwidget.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;firmwareiapobj.h&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="coreconstants_8h.html">coreplugin/coreconstants.h</a>&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="icore_8h.html">coreplugin/icore.h</a>&gt;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="modemanager_8h.html">coreplugin/modemanager.h</a>&gt;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="actionmanager_8h.html">coreplugin/actionmanager/actionmanager.h</a>&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rawhidplugin_8h.html">rawhid/rawhidplugin.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;ui_uploader.h&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="pluginmanager_8h.html">extensionsystem/pluginmanager.h</a>&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">using namespace </span>uploader;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="group___uploader.html#ga9a0bf1af93f4208e065382a88dda1b58">   58</a></span>&#160;<a class="code" href="group___uploader.html#ga9a0bf1af93f4208e065382a88dda1b58">UploaderGadgetWidget::UploaderGadgetWidget</a>(QWidget *parent)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    : QWidget(parent)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    , telemetryConnected(false)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    , iapUpdated(false)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    m_widget = <span class="keyword">new</span> Ui_UploaderWidget();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    m_widget-&gt;setupUi(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    m_widget-&gt;partitionBrowserTW-&gt;setSelectionMode(QAbstractItemView::SingleSelection);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    m_widget-&gt;partitionBrowserTW-&gt;setSelectionBehavior(QAbstractItemView::SelectRows);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// these widgets will be set to retain their position in the layout even when hidden</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="class_q_list.html">QList&lt;QWidget *&gt;</a> hideable = { m_widget-&gt;progressBar };</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">foreach</span> (QWidget *widget, hideable) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        QSizePolicy sp = widget-&gt;sizePolicy();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        sp.setRetainSizeWhenHidden(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        widget-&gt;setSizePolicy(sp);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// Setup partition manager actions</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    QAction *action = <span class="keyword">new</span> QAction(<span class="stringliteral">&quot;Save to file&quot;</span>, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    connect(action, &amp;QAction::triggered, <span class="keyword">this</span>, &amp;UploaderGadgetWidget::onPartitionSave);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    m_widget-&gt;partitionBrowserTW-&gt;addAction(action);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    action = <span class="keyword">new</span> QAction(<span class="stringliteral">&quot;Flash from file&quot;</span>, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    connect(action, &amp;QAction::triggered, <span class="keyword">this</span>, &amp;UploaderGadgetWidget::onPartitionFlash);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    m_widget-&gt;partitionBrowserTW-&gt;addAction(action);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    action = <span class="keyword">new</span> QAction(<span class="stringliteral">&quot;Erase&quot;</span>, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    connect(action, &amp;QAction::triggered, <span class="keyword">this</span>, &amp;UploaderGadgetWidget::onPartitionErase);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    m_widget-&gt;partitionBrowserTW-&gt;addAction(action);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    m_widget-&gt;partitionBrowserTW-&gt;setContextMenuPolicy(Qt::ActionsContextMenu);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// Clear widgets to defaults</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    FirmwareOnDeviceClear(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    FirmwareLoadedClear(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    PartitionBrowserClear();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    DeviceInformationClear();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    pm = ExtensionSystem::PluginManager::instance();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    telMngr = pm-&gt;getObject&lt;<a class="code" href="class_telemetry_manager.html">TelemetryManager</a>&gt;();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    utilMngr = pm-&gt;getObject&lt;<a class="code" href="class_u_a_v_object_util_manager.html">UAVObjectUtilManager</a>&gt;();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    importMngr = pm-&gt;getObject&lt;<a class="code" href="class_u_a_v_settings_import_export_manager.html">UAVSettingsImportExportManager</a>&gt;();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    netMngr = <span class="keyword">new</span> QNetworkAccessManager(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="class_u_a_v_object_manager.html">UAVObjectManager</a> *obm = pm-&gt;getObject&lt;<a class="code" href="class_u_a_v_object_manager.html">UAVObjectManager</a>&gt;();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">/* These (and firmwareIAP) are queued connections.  We may do things</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">     * that ultimately stop the telemetry manager, so we don&#39;t want to be</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">     * invoked from its components and return into it.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    connect(telMngr, &amp;<a class="code" href="group___u_a_v_talk_plugin.html#ga54bec8ecfe469710c7261f567e76c5f0">TelemetryManager::connected</a>, <span class="keyword">this</span>, &amp;UploaderGadgetWidget::onAutopilotConnect,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            Qt::QueuedConnection);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    connect(telMngr, &amp;<a class="code" href="group___u_a_v_talk_plugin.html#ga61e671949cc2403327617d9c9a372a76">TelemetryManager::disconnected</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            &amp;UploaderGadgetWidget::onAutopilotDisconnect, Qt::QueuedConnection);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    firmwareIap = FirmwareIAPObj::GetInstance(obm);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    connect(firmwareIap, &amp;<a class="code" href="group___u_a_v_objects_plugin.html#ga9aac3ae5395f63249cd821e0e5be5bf2">UAVObject::objectUpdated</a>, <span class="keyword">this</span>, &amp;UploaderGadgetWidget::onIAPUpdated,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            Qt::QueuedConnection);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Connect button signals to slots</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    connect(m_widget-&gt;openButton, &amp;QAbstractButton::clicked, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            &amp;UploaderGadgetWidget::onLoadFirmwareButtonClick);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    connect(m_widget-&gt;rescueButton, &amp;QAbstractButton::clicked, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            &amp;UploaderGadgetWidget::onRescueButtonClick);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    connect(m_widget-&gt;flashButton, &amp;QAbstractButton::clicked, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            &amp;UploaderGadgetWidget::onFlashButtonClick);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    connect(m_widget-&gt;bootButton, &amp;QAbstractButton::clicked, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            &amp;UploaderGadgetWidget::onBootButtonClick);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    connect(m_widget-&gt;safeBootButton, &amp;QAbstractButton::clicked, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            &amp;UploaderGadgetWidget::onBootButtonClick);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    connect(m_widget-&gt;exportConfigButton, &amp;QAbstractButton::clicked, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            &amp;UploaderGadgetWidget::onExportButtonClick);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    connect(m_widget-&gt;pbHelp, &amp;QAbstractButton::clicked, <span class="keyword">this</span>, &amp;UploaderGadgetWidget::openHelp);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="class_core_1_1_board_manager.html">Core::BoardManager</a> *brdMgr = <a class="code" href="group___core_plugin.html#ga71099762904aac0b404fcd1f93bdc83e">Core::ICore::instance</a>()-&gt;<a class="code" href="group___core_plugin.html#ga01532acba71e5af5bee3777209aebf7d">boardManager</a>();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// Setup usb discovery signals for boards in bl state</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    usbFilterBL = <span class="keyword">new</span> <a class="code" href="class_u_s_b_signal_filter.html">USBSignalFilter</a>(brdMgr-&gt;<a class="code" href="group___core_plugin.html#gaa37a0c8c804e3623c622cf8243bc7ef3">getKnownVendorIDs</a>(), -1, -1, <a class="code" href="group___raw_h_i_d_plugin.html#ggaff6bf8945a7cdab907cf5adc29bec064ac18f9b621b18e8d33c36467a92dd0dc9">USBMonitor::Bootloader</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    usbFilterUP = <span class="keyword">new</span> <a class="code" href="class_u_s_b_signal_filter.html">USBSignalFilter</a>(brdMgr-&gt;<a class="code" href="group___core_plugin.html#gaa37a0c8c804e3623c622cf8243bc7ef3">getKnownVendorIDs</a>(), -1, -1, <a class="code" href="group___raw_h_i_d_plugin.html#ggaff6bf8945a7cdab907cf5adc29bec064afacf3dc002126ce1b351fe373583f8a3">USBMonitor::Upgrader</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    connect(usbFilterBL, &amp;<a class="code" href="group___raw_h_i_d_plugin.html#ga8e42cdaa700116a4467d8ded1f506ed9">USBSignalFilter::deviceRemoved</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            &amp;UploaderGadgetWidget::onBootloaderRemoved, Qt::QueuedConnection);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    connect(usbFilterBL, &amp;<a class="code" href="group___raw_h_i_d_plugin.html#ga9d88c3bd1d000b31ad72af4735edaaf2">USBSignalFilter::deviceDiscovered</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            &amp;UploaderGadgetWidget::onBootloaderDetected, Qt::QueuedConnection);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    connect(usbFilterUP, &amp;<a class="code" href="group___raw_h_i_d_plugin.html#ga8e42cdaa700116a4467d8ded1f506ed9">USBSignalFilter::deviceRemoved</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            &amp;UploaderGadgetWidget::onBootloaderRemoved, Qt::QueuedConnection);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    connect(usbFilterUP, &amp;<a class="code" href="group___raw_h_i_d_plugin.html#ga9d88c3bd1d000b31ad72af4735edaaf2">USBSignalFilter::deviceDiscovered</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            &amp;UploaderGadgetWidget::onBootloaderDetected, Qt::QueuedConnection);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    connect(&amp;dfu, &amp;<a class="code" href="group___uploader.html#ga5804d2fb896816a6c1a7be7ca7774242">tl_dfu::DFUObject::operationProgress</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            &amp;UploaderGadgetWidget::onStatusUpdate);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    conMngr = <a class="code" href="group___core_plugin.html#ga71099762904aac0b404fcd1f93bdc83e">Core::ICore::instance</a>()-&gt;<a class="code" href="group___core_plugin.html#gab606d10ae8f0f9575d0e8ffb6e776ac7">connectionManager</a>();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">/* Enter the loader if it&#39;s available */</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6490cdc12cc97adfcc89f39adda55807">uploader::ENTERING_LOADER</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    onBootloaderDetected();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">/* Else begin our normal actions waitin&#39; for a board */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (getUploaderStatus() != <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;GCS ready for flight board connection...&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="group___uploader.html#ga81ab4c8e328f917680b38093e9c69e6c">  170</a></span>&#160;<a class="code" href="group___uploader.html#ga81ab4c8e328f917680b38093e9c69e6c">UploaderGadgetWidget::~UploaderGadgetWidget</a>()</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// TODO remove this when addObject removed from factory</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    ExtensionSystem::PluginManager::instance()-&gt;removeObject(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::FirmwareOnDeviceClear(<span class="keywordtype">bool</span> clear)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    QRegExp rx(<span class="stringliteral">&quot;*OD_lbl&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    rx.setPatternSyntax(QRegExp::Wildcard);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">foreach</span> (QLabel *l, findChildren&lt;QLabel *&gt;(rx)) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (clear)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            l-&gt;clear();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        l-&gt;setVisible(!clear);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    m_widget-&gt;firmwareOnDevicePic-&gt;setVisible(!clear);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    m_widget-&gt;noInfoOnDevice-&gt;setVisible(clear);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    m_widget-&gt;onDeviceGB-&gt;setEnabled(!clear);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::FirmwareLoadedClear(<span class="keywordtype">bool</span> clear)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    QRegExp rx(<span class="stringliteral">&quot;*LD_lbl&quot;</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    rx.setPatternSyntax(QRegExp::Wildcard);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">foreach</span> (QLabel *l, findChildren&lt;QLabel *&gt;(rx)) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span> (clear)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            l-&gt;clear();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        l-&gt;setVisible(!clear);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    m_widget-&gt;firmwareLoadedPic-&gt;setVisible(!clear);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    m_widget-&gt;noFirmwareLoaded-&gt;setVisible(clear);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    m_widget-&gt;loadedGB-&gt;setEnabled(!clear);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (clear)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        m_widget-&gt;userDefined_LD_lbl-&gt;clear();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    m_widget-&gt;userDefined_LD_lbl-&gt;setVisible(!clear);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::PartitionBrowserClear()</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;{</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    m_widget-&gt;partitionBrowserTW-&gt;clearContents();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    m_widget-&gt;partitionBrowserGB-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::DeviceInformationClear()</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    m_widget-&gt;deviceInformationMainLayout-&gt;setVisible(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    m_widget-&gt;deviceInformationNoInfo-&gt;setVisible(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    m_widget-&gt;boardName_lbl-&gt;setVisible(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    currentBoard.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a> = NULL;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::DeviceInformationUpdate(<a class="code" href="structdevice_info.html">deviceInfo</a> board)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (!board.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    currentBoard = board;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    m_widget-&gt;boardName_lbl-&gt;setText(board.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;boardDescription());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    m_widget-&gt;devName_lbl-&gt;setText(</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        board.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;getBoardNameFromID(board.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;getBoardType() &lt;&lt; 8));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    m_widget-&gt;hwRev_lbl-&gt;setText(board.<a class="code" href="structdevice_info.html#ac8171c63846102b491a666633b80aea4">hw_revision</a>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    m_widget-&gt;blVer_lbl-&gt;setText(board.<a class="code" href="structdevice_info.html#a11c0e01d0d01c04fb37571dfd72120a4">bl_version</a>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">bool</span> bl_version_ok;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">int</span> bl_version = board.<a class="code" href="structdevice_info.html#a11c0e01d0d01c04fb37571dfd72120a4">bl_version</a>.toInt(&amp;bl_version_ok, 16);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    m_widget-&gt;blVer_lbl-&gt;setStyleSheet(</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        bl_version_ok &amp;&amp; bl_version &lt; board.board-&gt;minBootLoaderVersion() ? <span class="stringliteral">&quot;color: red;&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    m_widget-&gt;maxCode_lbl-&gt;setText(board.<a class="code" href="structdevice_info.html#afca090b1aeead1545be65b70fb65f05a">max_code_size</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    m_widget-&gt;deviceInformationMainLayout-&gt;setVisible(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    m_widget-&gt;deviceInformationNoInfo-&gt;setVisible(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    m_widget-&gt;boardPic-&gt;setPixmap(board.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;getBoardPicture());</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    FirmwareLoadedUpdate(loadedFile);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::FirmwareOnDeviceUpdate(<a class="code" href="classdevice_descriptor_struct.html">deviceDescriptorStruct</a> firmware, QString <a class="code" href="uavobjecttemplate_8m.html#a6a3730e10b2455e9a8b6599785809fce">crc</a>)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    m_widget-&gt;builtForOD_lbl-&gt;setText(<a class="code" href="group___core_plugin.html#gaddaeace95ea23949d99762156cf96a98">Core::IBoardType::getBoardNameFromID</a>(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#gae920502ccf0fd693241d0d4b93dfc535">boardID</a>()));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    m_widget-&gt;crcOD_lbl-&gt;setText(crc);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    m_widget-&gt;gitHashOD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#ga7c265729bc1bc959e63a3c8f0f1543e8">gitHash</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    m_widget-&gt;ancestorHashOD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#gad367094e97afa14f347d454771e71642">nextAncestor</a>);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    m_widget-&gt;firmwareDateOD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#gaf7688dd9b2d5fe676da57bbca33e460d">gitDate</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    m_widget-&gt;firmwareTagOD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#ga69f44ea76d04a61aac18e4393eba4e84">gitTag</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    m_widget-&gt;uavosSHA_OD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#gaa4639a6c66d44d1f5e0bf6c22c5eec64">uavoHash</a>.toHex().toUpper());</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    m_widget-&gt;userDefined_OD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#ga48e724f021e815c98e2143dd6df1695b">userDefined</a>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span> (firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#ga49289a9802c5eec2cc8b0b38c7c88500">certified</a>) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        QPixmap pix = QPixmap(QString(<span class="stringliteral">&quot;:uploader/images/application-certificate.svg&quot;</span>));</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        m_widget-&gt;firmwareOnDevicePic-&gt;setPixmap(pix);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        m_widget-&gt;firmwareOnDevicePic-&gt;setToolTip(tr(<span class="stringliteral">&quot;Tagged officially released firmware build&quot;</span>));</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        QPixmap pix = QPixmap(QString(<span class="stringliteral">&quot;:uploader/images/warning.svg&quot;</span>));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        m_widget-&gt;firmwareOnDevicePic-&gt;setPixmap(pix);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        m_widget-&gt;firmwareOnDevicePic-&gt;setToolTip(tr(<span class="stringliteral">&quot;Custom Firmware Build&quot;</span>));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    FirmwareOnDeviceClear(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::FirmwareLoadedUpdate(QByteArray firmwareArray)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;{</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (firmwareArray.isEmpty())</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="classdevice_descriptor_struct.html">deviceDescriptorStruct</a> firmware;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span> (!utilMngr-&gt;<a class="code" href="group___u_a_v_objects_plugin.html#ga31c6b739ad7f06472a3f3386e4bebd8a">descriptionToStructure</a>(firmwareArray.right(100), firmware)) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Error parsing file metadata&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        QPixmap pix = QPixmap(QString(<span class="stringliteral">&quot;:uploader/images/error.svg&quot;</span>));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        m_widget-&gt;firmwareLoadedPic-&gt;setPixmap(pix);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        m_widget-&gt;firmwareLoadedPic-&gt;setToolTip(</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            tr(<span class="stringliteral">&quot;Error unrecognized file format, proceed at your own risk&quot;</span>));</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        m_widget-&gt;gitHashLD_lbl-&gt;setText(</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            tr(<span class="stringliteral">&quot;Error unrecognized file format, proceed at your own risk&quot;</span>));</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        FirmwareLoadedClear(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        m_widget-&gt;userDefined_LD_lbl-&gt;setVisible(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;File loaded successfully&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    m_widget-&gt;builtForLD_lbl-&gt;setText(<a class="code" href="group___core_plugin.html#gaddaeace95ea23949d99762156cf96a98">Core::IBoardType::getBoardNameFromID</a>(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#gae920502ccf0fd693241d0d4b93dfc535">boardID</a>()));</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">bool</span> ok;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    currentBoard.<a class="code" href="structdevice_info.html#afca090b1aeead1545be65b70fb65f05a">max_code_size</a>.toLong(&amp;ok);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> (!ok)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        m_widget-&gt;crcLD_lbl-&gt;setText(<span class="stringliteral">&quot;Not Available&quot;</span>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (firmwareArray.length() &gt; currentBoard.<a class="code" href="structdevice_info.html#afca090b1aeead1545be65b70fb65f05a">max_code_size</a>.toLong()) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        m_widget-&gt;crcLD_lbl-&gt;setText(<span class="stringliteral">&quot;Not Available&quot;</span>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        quint32 crc = dfu.CRCFromQBArray(firmwareArray, currentBoard.<a class="code" href="structdevice_info.html#afca090b1aeead1545be65b70fb65f05a">max_code_size</a>.toLong());</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        m_widget-&gt;crcLD_lbl-&gt;setText(QString::number(crc));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    m_widget-&gt;gitHashLD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#ga7c265729bc1bc959e63a3c8f0f1543e8">gitHash</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    m_widget-&gt;ancestorHashLD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#gad367094e97afa14f347d454771e71642">nextAncestor</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    m_widget-&gt;firmwareDateLD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#gaf7688dd9b2d5fe676da57bbca33e460d">gitDate</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    m_widget-&gt;firmwareTagLD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#ga69f44ea76d04a61aac18e4393eba4e84">gitTag</a>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    m_widget-&gt;uavosSHA_LD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#gaa4639a6c66d44d1f5e0bf6c22c5eec64">uavoHash</a>.toHex().toUpper());</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    m_widget-&gt;userDefined_LD_lbl-&gt;setText(firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#ga48e724f021e815c98e2143dd6df1695b">userDefined</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span> (currentBoard.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a> &amp;&amp; (currentBoard.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;getBoardType() != firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#ga2a96c0269c09447e493055692fd68ad5">boardType</a>)) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        QPixmap pix = QPixmap(QString(<span class="stringliteral">&quot;:uploader/images/error.svg&quot;</span>));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        m_widget-&gt;firmwareLoadedPic-&gt;setPixmap(pix);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        m_widget-&gt;firmwareLoadedPic-&gt;setToolTip(</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            tr(<span class="stringliteral">&quot;Error firmware loaded firmware doesn&#39;t match connected board&quot;</span>));</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (firmware.<a class="code" href="group___u_a_v_object_util_plugin.html#ga49289a9802c5eec2cc8b0b38c7c88500">certified</a>) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        QPixmap pix = QPixmap(QString(<span class="stringliteral">&quot;:uploader/images/application-certificate.svg&quot;</span>));</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        m_widget-&gt;firmwareLoadedPic-&gt;setPixmap(pix);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        m_widget-&gt;firmwareLoadedPic-&gt;setToolTip(tr(<span class="stringliteral">&quot;Tagged officially released firmware build&quot;</span>));</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        QPixmap pix = QPixmap(QString(<span class="stringliteral">&quot;:uploader/images/warning.svg&quot;</span>));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        m_widget-&gt;firmwareLoadedPic-&gt;setPixmap(pix);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        m_widget-&gt;firmwareLoadedPic-&gt;setToolTip(tr(<span class="stringliteral">&quot;Custom Firmware Build&quot;</span>));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    FirmwareLoadedClear(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onAutopilotConnect()</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    telemetryConnected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    CheckAutopilotReady();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onAutopilotDisconnect()</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;{</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    FirmwareOnDeviceClear(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    DeviceInformationClear();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    PartitionBrowserClear();</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    telemetryConnected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    iapUpdated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> (getUploaderStatus() == <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6490cdc12cc97adfcc89f39adda55807">uploader::ENTERING_LOADER</a>)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (getUploaderStatus() == <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a9068a448064dd9c673d038228a0531da">uploader::UPGRADING_CATCHLOADER</a>)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Telemetry disconnected&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onAutopilotReady()</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6f34924bb42c3b036dedf26458bb370e">uploader::CONNECTED_TO_TELEMETRY</a>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Telemetry connected&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a>);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="structdevice_info.html">deviceInfo</a> board;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    board.<a class="code" href="structdevice_info.html#a11c0e01d0d01c04fb37571dfd72120a4">bl_version</a> = tr(<span class="stringliteral">&quot;Not available&quot;</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    board.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a> = utilMngr-&gt;<a class="code" href="group___u_a_v_objects_plugin.html#gac3a1293716fa3eb310ed257ade7f6722">getBoardType</a>();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    board.<a class="code" href="structdevice_info.html#a4c7f3d6cd35d1cd5f8756075d915d704">cpu_serial</a> = utilMngr-&gt;<a class="code" href="group___u_a_v_object_util_plugin.html#ga11c8171d7e380e699b4edf9b6860a236">getBoardCPUSerial</a>().toHex();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    board.<a class="code" href="structdevice_info.html#ac8171c63846102b491a666633b80aea4">hw_revision</a> = QString::number(utilMngr-&gt;<a class="code" href="group___u_a_v_objects_plugin.html#ga20e8da6668f3dfb1231b33e7b44af01c">getBoardRevision</a>());</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    board.<a class="code" href="structdevice_info.html#afca090b1aeead1545be65b70fb65f05a">max_code_size</a> = tr(<span class="stringliteral">&quot;Not available&quot;</span>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    DeviceInformationUpdate(board);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="classdevice_descriptor_struct.html">deviceDescriptorStruct</a> device;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> (utilMngr-&gt;<a class="code" href="group___u_a_v_objects_plugin.html#gab0eb14551119e370daee5cf188961831">getBoardDescriptionStruct</a>(device)) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        FirmwareOnDeviceUpdate(device, QString::number(utilMngr-&gt;<a class="code" href="group___u_a_v_objects_plugin.html#ga2aa3a13d1eb39329f28842887c6d7db6">getFirmwareCRC</a>()));</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">if</span> (FirmwareCheckForUpdate(device)) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            onRescueButtonClick();</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <a class="code" href="group___core_plugin.html#ga756ec59f5104cce0abf8a6990a2bba2c">Core::ModeManager::instance</a>()-&gt;<a class="code" href="group___core_plugin.html#gadd4b3b24c51d0993e61aab8ee9e76f48">activateModeByWorkspaceName</a>(<span class="stringliteral">&quot;Firmware&quot;</span>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="comment">// Set the status, so when we enter the loader we cue the</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="comment">// upgrade state machine/actions.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690abdbbfac16910eb802bf70df43588787e">uploader::UPGRADING</a>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    emit <a class="code" href="group___uploader.html#ga39018319f1ee8c5732861b209b79e747">newBoardSeen</a>(board, device);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onIAPUpdated()</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">if</span> ((getUploaderStatus() == <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6490cdc12cc97adfcc89f39adda55807">uploader::ENTERING_LOADER</a>)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        || (getUploaderStatus() == <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690abdbbfac16910eb802bf70df43588787e">uploader::UPGRADING</a>))</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    iapUpdated = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    CheckAutopilotReady();</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onLoadFirmwareButtonClick()</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;{</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    QString board;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (currentBoard.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        board = currentBoard.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;shortName().toLower();</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    QString filename = LoadFirmwareFileDialog(board);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> (filename.isEmpty()) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Open cancelled&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    QFile <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>(filename);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.open(QIODevice::ReadOnly)) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Could not open file&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    loadedFile = <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.readAll();</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    FirmwareLoadedClear(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    FirmwareLoadedUpdate(loadedFile);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    setUploaderStatus(getUploaderStatus());</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">// Would be nice to do the work here required to constify firmwareImage</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keywordtype">bool</span> UploaderGadgetWidget::flashFirmware(QByteArray &amp;firmwareImage)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;{</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    QEventLoop loop;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    QTimer timeout;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    connect(&amp;timeout, &amp;QTimer::timeout, &amp;loop, &amp;QEventLoop::quit);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    timeout.setSingleShot(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    timeout.start(120000); <span class="comment">// Very long out of caution. Current Brain</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// FW takes 36-37 seconds on some machines to</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// flash.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="group___uploader.html#ga5668196b7ff4028f1f71803e9ff5c7c4">tl_dfu::Status</a> operationSuccess = <a class="code" href="group___uploader.html#gga5668196b7ff4028f1f71803e9ff5c7c4a563943e44f2724d6fd4f42d093712350">DFUidle</a>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    setStatusInfo(<span class="stringliteral">&quot;&quot;</span>, <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308da13af96448b88ff31b53c18995e183a3f">uploader::STATUSICON_RUNNING</a>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a71fc8eb4458bbae2d4773e7bd9209575">uploader::BL_BUSY</a>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    onStatusUpdate(QString(<span class="stringliteral">&quot;Starting upload...&quot;</span>), 0); <span class="comment">// set progress bar to 0 while erasing</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    dfu.UploadPartitionThreaded(firmwareImage, <a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997fea21fd6b3ea09d1ff3bca44a7facf73e8e">DFU_PARTITION_FW</a>,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                currentBoard.<a class="code" href="structdevice_info.html#afca090b1aeead1545be65b70fb65f05a">max_code_size</a>.toInt());</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">/* disconnects when loop comes out of scope */</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    connect(&amp;dfu, &amp;DFUObject::uploadFinished, &amp;loop, [&amp;](<a class="code" href="group___uploader.html#ga5668196b7ff4028f1f71803e9ff5c7c4">tl_dfu::Status</a> status) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        operationSuccess = status;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        loop.exit();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    });</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    loop.exec(); <span class="comment">/* Wait for timeout or download complete */</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    timeout.stop();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (operationSuccess != <a class="code" href="group___uploader.html#gga5668196b7ff4028f1f71803e9ff5c7c4a9e44395ad4ded84b53a90b8664d86947">Last_operation_Success</a>) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Firmware upload failed&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Firmware upload success&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">if</span> ((!firmwareImage.right(100).startsWith(<span class="stringliteral">&quot;TlFw&quot;</span>))</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        &amp;&amp; (!firmwareImage.right(100).startsWith(<span class="stringliteral">&quot;OpFw&quot;</span>))) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    tempArray.clear();</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    tempArray.append(firmwareImage.right(100));</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    tempArray.chop(12);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    QString user(<span class="stringliteral">&quot;            &quot;</span>);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    user = user.replace(0, m_widget-&gt;userDefined_LD_lbl-&gt;text().length(),</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                        m_widget-&gt;userDefined_LD_lbl-&gt;text());</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    tempArray.append(user.toLatin1());</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Starting firmware metadata upload&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    dfu.UploadPartitionThreaded(tempArray, <a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997fea6a3d4ee0f00e71f903a165e9fbb10c93">DFU_PARTITION_DESC</a>, 100);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    operationSuccess = <a class="code" href="group___uploader.html#gga5668196b7ff4028f1f71803e9ff5c7c4a563943e44f2724d6fd4f42d093712350">DFUidle</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    timeout.start(10000);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    loop.exec();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    timeout.stop();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span> (operationSuccess != <a class="code" href="group___uploader.html#gga5668196b7ff4028f1f71803e9ff5c7c4a9e44395ad4ded84b53a90b8664d86947">Last_operation_Success</a>) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Firmware metadata upload failed&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Firmware and firmware metadata upload success&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// uploaded succeeded so we can assume the loaded file is on the board</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="classdevice_descriptor_struct.html">deviceDescriptorStruct</a> descStructure;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group___u_a_v_objects_plugin.html#ga31c6b739ad7f06472a3f3386e4bebd8a">UAVObjectUtilManager::descriptionToStructure</a>(tempArray, descStructure)) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        quint32 crc = dfu.CRCFromQBArray(firmwareImage, currentBoard.<a class="code" href="structdevice_info.html#afca090b1aeead1545be65b70fb65f05a">max_code_size</a>.toLong());</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        FirmwareOnDeviceUpdate(descStructure, QString::number(crc));</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onFlashButtonClick()</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;{</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">if</span> (flashFirmware(loadedFile)) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        this-&gt;activateWindow();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        m_widget-&gt;bootButton-&gt;setFocus();</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;}</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::haltOrReset(<span class="keywordtype">bool</span> halting)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;{</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span> (!firmwareIap-&gt;getIsPresentOnHardware())</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">if</span> (halting) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6490cdc12cc97adfcc89f39adda55807">uploader::ENTERING_LOADER</a>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    QEventLoop loop;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    QTimer timeout;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    timeout.setSingleShot(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    firmwareIap-&gt;setBoardRevision(0);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    firmwareIap-&gt;setBoardType(0);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    connect(&amp;timeout, &amp;QTimer::timeout, &amp;loop, &amp;QEventLoop::quit);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    connect(firmwareIap, QOverload&lt;UAVObject *, bool&gt;::of(&amp;FirmwareIAPObj::transactionCompleted),</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            &amp;loop, &amp;QEventLoop::quit);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">int</span> magicValue = 1122;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordtype">int</span> magicStep = 1111;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="_o_p_plots_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 0; <a class="code" href="_o_p_plots_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> &lt; 3; ++<a class="code" href="_o_p_plots_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="comment">// Firmware IAP module specifies that the timing between iap commands must be</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="comment">// between 500 and 5000ms</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        timeout.start(600);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        loop.exec();</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        firmwareIap-&gt;setCommand(magicValue);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        magicValue += magicStep;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">if</span> ((!halting) &amp;&amp; (magicValue == 3344))</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            magicValue = 4455;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        setStatusInfo(QString(tr(<span class="stringliteral">&quot;Sending IAP Step %0&quot;</span>).arg(<a class="code" href="_o_p_plots_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> + 1)), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        firmwareIap-&gt;updated();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        timeout.start(1000);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        loop.exec();</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordflow">if</span> (!timeout.isActive()) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            setStatusInfo(QString(tr(<span class="stringliteral">&quot;Sending IAP Step %0 failed&quot;</span>).arg(<a class="code" href="_o_p_plots_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> + 1)),</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                          <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        timeout.stop();</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <a class="code" href="class_core_1_1_i_connection.html">Core::IConnection</a> *conn = conMngr-&gt;<a class="code" href="group___core_plugin.html#ga93568acf4b301c44a1d9bf243066f3ff">getCurrentDevice</a>().<a class="code" href="group___core_plugin.html#ga90db60736480bb690e6ec029acbce4d1">connection</a>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">if</span> (conn &amp;&amp; conn-&gt;<a class="code" href="group___core_plugin.html#gad436df0a83378128cb8034d83e6734f0">shortName</a>() == <span class="stringliteral">&quot;USB&quot;</span>) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        conMngr-&gt;<a class="code" href="group___core_plugin.html#ga679b06064b497205af5453783acff419">disconnectDevice</a>();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        timeout.start(200);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        loop.exec();</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        timeout.stop();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        conMngr-&gt;<a class="code" href="group___core_plugin.html#gad4e7e06b9cc1c4720a0bb9202c5dca19">suspendPolling</a>();</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        startRescue();</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        conMngr-&gt;<a class="code" href="group___core_plugin.html#ga679b06064b497205af5453783acff419">disconnectDevice</a>();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onRescueButtonClick()</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;{</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">if</span> (telMngr-&gt;<a class="code" href="group___u_a_v_talk_plugin.html#ga753148204d39c087c9aa27c9dbe9df98">isConnected</a>()) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="comment">// This means &quot;halt&quot; to enter the loader.</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        haltOrReset(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">// Otherwise, this means &quot;begin rescue&quot;.</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    conMngr-&gt;<a class="code" href="group___core_plugin.html#gad4e7e06b9cc1c4720a0bb9202c5dca19">suspendPolling</a>();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6490cdc12cc97adfcc89f39adda55807">uploader::ENTERING_LOADER</a>);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Please connect the board with USB with no external power applied&quot;</span>),</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                  <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a>);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    startRescue();</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;}</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="keywordtype">bool</span> UploaderGadgetWidget::downloadSettings()</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;{</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    QEventLoop loop;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    QTimer timeout;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    timeout.setSingleShot(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordtype">bool</span> operationSuccess = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    connect(&amp;timeout, &amp;QTimer::timeout, &amp;loop, &amp;QEventLoop::quit);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">/* disconnects when loop comes out of scope */</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    connect(&amp;dfu, &amp;DFUObject::downloadFinished, &amp;loop, [&amp;](<span class="keywordtype">bool</span> status) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        qDebug() &lt;&lt; <span class="stringliteral">&quot;downloadFinished in dSettings: &quot;</span> &lt;&lt; status;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        operationSuccess = status;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        loop.exit();</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    });</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    timeout.start(100000); <span class="comment">/* 100 secs is a long time; unfortunately</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">                            * revo settings part is HUUUUGE and takes</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">                            * forever to download. */</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    triggerPartitionDownload(<a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feaee07f6612e39b0d73a7314fe713e43e3">DFU_PARTITION_SETTINGS</a>);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    loop.exec(); <span class="comment">/* Wait for timeout or download complete */</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    timeout.stop();</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">return</span> operationSuccess;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;}</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keywordtype">bool</span> UploaderGadgetWidget::askIfShouldContinue()</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;{</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    QMessageBox msgBox;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    msgBox.setText(tr(<span class="stringliteral">&quot;Proceed without saving a configuration backup?&quot;</span>));</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    msgBox.setInformativeText(tr(<span class="stringliteral">&quot;It is strongly encouraged that you save a backup of the &quot;</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                 <span class="stringliteral">&quot;configuration before proceeding with upgrade.&quot;</span>));</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    msgBox.setStandardButtons(QMessageBox::Yes | QMessageBox::No);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    msgBox.setDefaultButton(QMessageBox::No);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordtype">int</span> val = msgBox.exec();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">if</span> (val == QMessageBox::Yes) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;}</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordtype">bool</span> UploaderGadgetWidget::saveSettings(<span class="keyword">const</span> QByteArray &amp;settingsDump)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;{</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">/* save dialog for XML config */</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    QString filename = QFileDialog::getSaveFileName(<span class="keyword">this</span>, tr(<span class="stringliteral">&quot;Save Settings Backup&quot;</span>),</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                                    <span class="stringliteral">&quot;cloud_exported.uav&quot;</span>, <span class="stringliteral">&quot;*.uav&quot;</span>);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">if</span> (filename.isEmpty()) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Save cancelled.&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">if</span> (!filename.endsWith(<span class="stringliteral">&quot;.uav&quot;</span>, Qt::CaseInsensitive))</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        filename.append(<span class="stringliteral">&quot;.uav&quot;</span>);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    QFile <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>(filename);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.open(QIODevice::WriteOnly)) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Error could not open file for save&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.write(settingsDump);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.close();</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Dump of configuration saved to file!&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">// Returns negative (&lt;0) if we can&#39;t get to the cloud.</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">// Returns false (0) if the cloud doesn&#39;t have our release</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">// Returns true (&gt;0) if the cloud has our release and would be glad to</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">// upgrade us.</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keywordtype">int</span> UploaderGadgetWidget::isCloudReleaseAvailable(QString srcRelease)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;{</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    QUrl url(hasRevUrl.arg(srcRelease));</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    QNetworkRequest request(url);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    QNetworkReply *reply = netMngr-&gt;head(request);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    QEventLoop loop;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    QTimer timeout;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    timeout.setSingleShot(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    connect(&amp;timeout, &amp;QTimer::timeout, &amp;loop, &amp;QEventLoop::quit);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    connect(reply, &amp;QNetworkReply::finished, &amp;loop, &amp;QEventLoop::quit);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    timeout.start(64000); <span class="comment">/* 64 seconds */</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    loop.exec();</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    timeout.stop();</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">if</span> (!reply-&gt;isFinished()) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Timeout communicating with cloud service&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    QVariant statusCode = reply-&gt;attribute(QNetworkRequest::HttpStatusCodeAttribute);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordtype">int</span> code = statusCode.toInt();</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">if</span> (code == 200)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">if</span> (code == 404)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">return</span> -1; <span class="comment">// Unexpected error code</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;}</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordtype">bool</span> UploaderGadgetWidget::tradeSettingsWithCloud(QString srcRelease, QString ancestor,</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                                                  <span class="keywordtype">bool</span> upgrading, QByteArray *settingsOut)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;{</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">/* post to cloud service */</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    QUrl url(exportUrl);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    QNetworkRequest request(url);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    QHttpMultiPart *multiPart = <span class="keyword">new</span> QHttpMultiPart(QHttpMultiPart::FormDataType);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span> (settingsOut != NULL) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        settingsOut-&gt;clear();</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">// ZLib compress the data</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    QByteArray compressed = qCompress(tempArray, 8);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="comment">// Remove the first 4 bytes, because Qt prepends expected length</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">// (not compatible with zlib)</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    compressed.remove(0, 4);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    QHttpPart githash, ancestorPart, adaptTo, datafile;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    githash.setHeader(QNetworkRequest::ContentDispositionHeader,</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                      QVariant(<span class="stringliteral">&quot;form-data; name=\&quot;githash\&quot;&quot;</span>));</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    githash.setBody(srcRelease.toLatin1());</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    ancestorPart.setHeader(QNetworkRequest::ContentDispositionHeader,</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                           QVariant(<span class="stringliteral">&quot;form-data; name=\&quot;ancestor\&quot;&quot;</span>));</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    ancestorPart.setBody(ancestor.toLatin1());</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keyword">const</span> QString gcsRev(<a class="code" href="group___core_plugin.html#ga6978a5ac87f3d9dcd891f1be551d3b87">Core::Constants::GCS_REVISION_STR</a>);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    adaptTo.setHeader(QNetworkRequest::ContentDispositionHeader,</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                      QVariant(<span class="stringliteral">&quot;form-data; name=\&quot;adaptTo\&quot;&quot;</span>));</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    adaptTo.setBody(gcsRev.toLatin1());</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    datafile.setHeader(QNetworkRequest::ContentTypeHeader, QVariant(<span class="stringliteral">&quot;application/octet-stream&quot;</span>));</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    datafile.setHeader(QNetworkRequest::ContentDispositionHeader,</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                       QVariant(<span class="stringliteral">&quot;form-data; filename=\&quot;datafile\&quot;; name=\&quot;datafile\&quot;&quot;</span>));</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    datafile.setBody(compressed);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    multiPart-&gt;append(githash);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    multiPart-&gt;append(adaptTo);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    multiPart-&gt;append(ancestorPart);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    multiPart-&gt;append(datafile);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    QNetworkReply *reply = netMngr-&gt;post(request, multiPart);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    QEventLoop loop;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    QTimer timeout;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    timeout.setSingleShot(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    connect(&amp;timeout, &amp;QTimer::timeout, &amp;loop, &amp;QEventLoop::quit);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    connect(reply, &amp;QNetworkReply::finished, &amp;loop, &amp;QEventLoop::quit);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    timeout.start(20000); <span class="comment">/* 20 seconds */</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    loop.exec();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    timeout.stop();</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">if</span> (!reply-&gt;isFinished()) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Timeout communicating with cloud service&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    QVariant statusCode = reply-&gt;attribute(QNetworkRequest::HttpStatusCodeAttribute);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordtype">int</span> code = statusCode.toInt();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span> (code != 200) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Received status code %1 from cloud&quot;</span>).arg(code),</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                      <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Retrieved dump of configuration from cloud&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    settingsDump = reply-&gt;readAll();</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">if</span> (settingsOut != NULL) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        *settingsOut = settingsDump;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">if</span> (upgrading) {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">return</span> saveSettings(settingsDump);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;}</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::upgradeError(QString why)</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;{</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    upgraderActive = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    Q_UNUSED(why);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    m_dialog.hide();</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;Upgrade assistant failed: &quot;</span> + why;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">/* Pop up a proper error dialog */</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    QMessageBox msgBox;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    msgBox.setIcon(QMessageBox::Critical);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    msgBox.setText(tr(<span class="stringliteral">&quot;Automatic upgrade failed.&quot;</span>));</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    msgBox.setInformativeText(why);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    msgBox.setStandardButtons(QMessageBox::Ok);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    msgBox.exec();</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;}</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::stepChangeAndDelay(QEventLoop &amp;loop, <span class="keywordtype">int</span> delayMs,</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                              <a class="code" href="group___uploader.html#ga77a98a88ccfc2d6f0236ec9e053da638">UpgradeAssistantDialog::UpgradeAssistantStep</a> step)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;{</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    m_dialog.<a class="code" href="group___uploader.html#ga245cc1bb639b28a773705eb968b6b770">onStepChanged</a>(step);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    QTimer delay;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    delay.setSingleShot(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    connect(&amp;delay, &amp;QTimer::timeout, &amp;loop, &amp;QEventLoop::quit);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    delay.start(delayMs);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    loop.exec();</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    delay.stop();</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;}</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::doUpgradeOperation(<span class="keywordtype">bool</span> blankFC, <a class="code" href="structtl__dfu_1_1device.html">tl_dfu::device</a> &amp;dev)</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;{</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    upgraderActive = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="group___core_plugin.html#ga756ec59f5104cce0abf8a6990a2bba2c">Core::ModeManager::instance</a>()-&gt;<a class="code" href="group___core_plugin.html#gadd4b3b24c51d0993e61aab8ee9e76f48">activateModeByWorkspaceName</a>(<span class="stringliteral">&quot;Firmware&quot;</span>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    m_dialog.<a class="code" href="group___uploader.html#ga245cc1bb639b28a773705eb968b6b770">onStepChanged</a>(<a class="code" href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638ae5a335d0c9f77d5e549b8fb85921f313">UpgradeAssistantDialog::STEP_ENTERLOADER</a>);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    m_dialog.<a class="code" href="group___uploader.html#ga523a8cbb5c228bfb1678274a09c4b91d">setOperatingMode</a>(<span class="keyword">true</span>, blankFC);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    QEventLoop loop;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    QTimer timeout;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    timeout.setSingleShot(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordtype">bool</span> aborted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordtype">bool</span> entLoader = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keyword">struct </span><a class="code" href="structdevice_info.html">deviceInfo</a> board = currentBoard;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    connect(&amp;timeout, &amp;QTimer::timeout, &amp;loop, &amp;QEventLoop::quit);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    connect(&amp;m_dialog, &amp;UpgradeAssistantDialog::finished, &amp;loop, [&amp;](<span class="keywordtype">int</span> result) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        (<a class="code" href="group___u_a_v_objects_plugin.html#ga444cf2ff3f0ecbe028adce838d373f5c">void</a>)result;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        aborted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        loop.exit();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    });</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    connect(<span class="keyword">this</span>, &amp;<a class="code" href="group___uploader.html#ga87d448f5964c57b1342f16f75bedc721">UploaderGadgetWidget::enteredLoader</a>, &amp;loop, [&amp;]() {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        entLoader = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        loop.exit();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    });</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    m_dialog.open();</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">if</span> (uploaderStatus != <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        upgradeError(tr(<span class="stringliteral">&quot;Not in expected bootloader state!&quot;</span>));</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">/* Save the version to convert from, so we can tell the cloud service */</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    QString upgradingFrom = m_widget-&gt;gitHashOD_lbl-&gt;text();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    QString ancestor = m_widget-&gt;ancestorHashOD_lbl-&gt;text();</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;Upgrading from &quot;</span> &lt;&lt; upgradingFrom;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">/* Infer what operations we need to do -- first, do they need a new</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">     * bootloader? */</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordtype">bool</span> upgradingLoader = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="comment">/* If no settings part known, new loader needed. */</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    upgradingLoader = !haveSettingsPart();</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordtype">int</span> requiredLoader = board.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;minBootLoaderVersion();</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> (requiredLoader &gt; dev.<a class="code" href="group___uploader.html#ga6f584609b0c34d0a6e9f4f25168bf901">BL_Version</a>) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        upgradingLoader = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    m_dialog.<a class="code" href="group___uploader.html#ga523a8cbb5c228bfb1678274a09c4b91d">setOperatingMode</a>(upgradingLoader, blankFC);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (!blankFC) {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        stepChangeAndDelay(loop, 400, <a class="code" href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a346336db514620881dffc585abb08657">UpgradeAssistantDialog::STEP_CHECKCLOUD</a>);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordtype">int</span> available = isCloudReleaseAvailable(upgradingFrom);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keywordflow">if</span> (available == 0) {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            available = isCloudReleaseAvailable(ancestor);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="keywordflow">if</span> (available &lt; 0) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <span class="comment">// Cloud service missing.  Pop up a dialog and ask user what to</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <span class="comment">// do.</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <span class="keywordtype">int</span> val =</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                QMessageBox::critical(<span class="keyword">this</span>, tr(<span class="stringliteral">&quot;Cloud upgrade service not available&quot;</span>),</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                      tr(<span class="stringliteral">&quot;The cloud upgrade service is not reachable. &quot;</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                         <span class="stringliteral">&quot;You may continue without migrating settings, &quot;</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                         <span class="stringliteral">&quot;or cancel the upgrade.&quot;</span>),</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                      QMessageBox::Ok | QMessageBox::Cancel, QMessageBox::Cancel);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="keywordflow">if</span> (val != QMessageBox::Ok) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                aborted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                blankFC = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (available == 0) {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <span class="comment">// Cloud service doesn&#39;t know about source release.  Pop up a</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <span class="comment">// dialog and ask what to do.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="keywordtype">int</span> val = QMessageBox::critical(<span class="keyword">this</span>, tr(<span class="stringliteral">&quot;Cloud upgrade service: release unknown&quot;</span>),</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                            tr(<span class="stringliteral">&quot;The cloud upgrade service does not know about &quot;</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                               <span class="stringliteral">&quot;the firmware on the flight controller. &quot;</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                               <span class="stringliteral">&quot;You may discard the existing settings, &quot;</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                               <span class="stringliteral">&quot;cancel the upgrade, or ignore and attempt to &quot;</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                               <span class="stringliteral">&quot;proceed with migration anyways.&quot;</span>),</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                            QMessageBox::Discard | QMessageBox::Cancel</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                                | QMessageBox::Ignore,</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                            QMessageBox::Cancel);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="keywordflow">if</span> (val == QMessageBox::Discard) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                blankFC = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (val != QMessageBox::Ignore) {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                aborted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    }</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="comment">// Set this again, as we could have decided to treat the board as blank.</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    m_dialog.<a class="code" href="group___uploader.html#ga523a8cbb5c228bfb1678274a09c4b91d">setOperatingMode</a>(upgradingLoader, blankFC);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="comment">/* gather up bootupdater and firmware images as needed,</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">     * so we spot errors before we do destructive things */</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    QByteArray bootUpdateFile, firmwareFile;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">if</span> (upgradingLoader) {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">if</span> (!FirmwareLoadFromFile(getImagePath(board.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;shortName(), <span class="stringliteral">&quot;bu&quot;</span>), &amp;bootUpdateFile)) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            upgradeError(tr(<span class="stringliteral">&quot;Unable to load bootloader update image for board!&quot;</span>));</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">if</span> (!FirmwareLoadFromFile(getImagePath(board.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;shortName(), <span class="stringliteral">&quot;fw&quot;</span>), &amp;firmwareFile)) {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        upgradeError(tr(<span class="stringliteral">&quot;Unable to load firmware image for board!&quot;</span>));</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">if</span> (upgradingLoader) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        stepChangeAndDelay(loop, 400, <a class="code" href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a07c67d2e649a55c2dabbcd17434ffc1f">UpgradeAssistantDialog::STEP_UPGRADEBOOTLOADER</a>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="comment">/* program the boot upgrader tool */</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        FirmwareLoadedClear(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        FirmwareLoadedUpdate(bootUpdateFile);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        setUploaderStatus(getUploaderStatus());</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordflow">if</span> (!flashFirmware(bootUpdateFile)) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            upgradeError(tr(<span class="stringliteral">&quot;Unable to flash upgrader image to board!&quot;</span>));</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        entLoader = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a9068a448064dd9c673d038228a0531da">uploader::UPGRADING_CATCHLOADER</a>);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        dfu.JumpToApp(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        dfu.CloseBootloaderComs();</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <span class="comment">/* Wait for / detect main loader */</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        timeout.start(25000);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        loop.exec();</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        timeout.stop();</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="keywordflow">if</span> (!entLoader) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            upgradeError(tr(<span class="stringliteral">&quot;Unable to enter bootloader after bootloader upgrade!&quot;</span>));</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    QByteArray xmlDump;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">if</span> (!blankFC) {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        stepChangeAndDelay(loop, 400, <a class="code" href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a854ed60a3846f938d6db376e0f3b3cff">UpgradeAssistantDialog::STEP_DOWNLOADSETTINGS</a>);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="comment">/* download the settings partition from the board */</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keywordflow">if</span> (!downloadSettings()) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            upgradeError(tr(<span class="stringliteral">&quot;Unable to pull settings partition!&quot;</span>));</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        stepChangeAndDelay(loop, 100, <a class="code" href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638ab6ba6c9dae0eb16c08ccfe66e1005a0e">UpgradeAssistantDialog::STEP_TRANSLATESETTINGS</a>);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="comment">/* translate the settings using the cloud service */</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordflow">if</span> (!tradeSettingsWithCloud(upgradingFrom, ancestor, <span class="keyword">true</span>, &amp;xmlDump)) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            upgradeError(tr(<span class="stringliteral">&quot;Unable to use cloud services to translate settings!&quot;</span>));</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordtype">bool</span> done = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            ret = m_dialog.<a class="code" href="group___uploader.html#gaea10e87c01ae547b8a9ebdd37e45d399">PromptUser</a>(tr(<span class="stringliteral">&quot;Obtained settings from cloud.&quot;</span>),</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                                      tr(<span class="stringliteral">&quot;It is recommended that you save a backup of the settings &quot;</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                                         <span class="stringliteral">&quot;before proceeding with upgrade.&quot;</span>),</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                                      QStringList() &lt;&lt; tr(<span class="stringliteral">&quot;Continue without saving&quot;</span>)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                                    &lt;&lt; tr(<span class="stringliteral">&quot;Save settings backup&quot;</span>));</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="keywordflow">switch</span> (ret) {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            <span class="keywordflow">case</span> 0: <span class="comment">/* continue */</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                done = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <span class="keywordflow">case</span> 1: <span class="comment">/* save settings backup */</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                <span class="comment">/* try to save. if successful, set done */</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                done = saveSettings(xmlDump);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    stepChangeAndDelay(loop, 400, <a class="code" href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a8e29c859eaa872af281c27107856fbae">UpgradeAssistantDialog::STEP_ERASESETTINGS</a>);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">/* wipe the board setting partition in prepation of upgrade */</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">if</span> (!dfu.WipePartition(<a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feaee07f6612e39b0d73a7314fe713e43e3">DFU_PARTITION_SETTINGS</a>)) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        upgradeError(tr(<span class="stringliteral">&quot;Failed to erase settings partition!&quot;</span>));</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    stepChangeAndDelay(loop, 400, <a class="code" href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a46a023cecebac11a9cae261d09c1d882">UpgradeAssistantDialog::STEP_FLASHFIRMWARE</a>);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">/* flash the appropriate main firmware image */</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    FirmwareLoadedClear(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    FirmwareLoadedUpdate(firmwareFile);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    setUploaderStatus(getUploaderStatus());</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    loop.processEvents();</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span> (!flashFirmware(firmwareFile)) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        upgradeError(tr(<span class="stringliteral">&quot;Unable to flash firmware image to board!&quot;</span>));</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="comment">/* Set ignoredrev to what we just programmed, so if we programmed</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">     * an outdated rev in a developer environment we don&#39;t immediately bop</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">     * up the message */</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    ignoredRev = m_widget-&gt;gitHashOD_lbl-&gt;text();</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    stepChangeAndDelay(loop, 400, <a class="code" href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a53a7b75423c01453fe089ae707271189">UpgradeAssistantDialog::STEP_BOOT</a>);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordtype">bool</span> firmwareConnected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="comment">/* start firmware and wait for telemetry connection */</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    connect(telMngr, &amp;<a class="code" href="group___u_a_v_talk_plugin.html#ga54bec8ecfe469710c7261f567e76c5f0">TelemetryManager::connected</a>, &amp;loop, [&amp;]() {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        firmwareConnected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        loop.exit();</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    });</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    dfu.JumpToApp(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    dfu.CloseBootloaderComs();</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tries = 0; tries &lt; 2; tries++) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        timeout.start(25000);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="keywordflow">if</span> (!firmwareConnected) {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            loop.exec();</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        timeout.stop();</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keywordflow">if</span> (!firmwareConnected) {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <span class="keywordflow">if</span> (tries == 0) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                ret = m_dialog.<a class="code" href="group___uploader.html#gaea10e87c01ae547b8a9ebdd37e45d399">PromptUser</a>(tr(<span class="stringliteral">&quot;Unable to automatically reset board&quot;</span>),</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                          tr(<span class="stringliteral">&quot;Please remove power and USB from the flight board, &quot;</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                                             <span class="stringliteral">&quot; plug it back in, and select \&quot;Continue.\&quot;&quot;</span>),</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                                          QStringList() &lt;&lt; tr(<span class="stringliteral">&quot;Continue&quot;</span>));</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                upgradeError(tr(<span class="stringliteral">&quot;Unable to connect to new firmware!&quot;</span>));</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        }</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">if</span> (!blankFC) {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        stepChangeAndDelay(loop, 400, <a class="code" href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a9ddebf132c47f8d9e2e2177c0f75f817">UpgradeAssistantDialog::STEP_IMPORT</a>);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            <span class="keywordflow">if</span> (aborted) {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                upgradeError(tr(<span class="stringliteral">&quot;Aborted!&quot;</span>));</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            ret = m_dialog.<a class="code" href="group___uploader.html#gaea10e87c01ae547b8a9ebdd37e45d399">PromptUser</a>(tr(<span class="stringliteral">&quot;Please review the imported settings and save to board.&quot;</span>),</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                      tr(<span class="stringliteral">&quot;No settings are currently saved. Select the &quot;</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                                         <span class="stringliteral">&quot;\&quot;Review and Save\&quot; button to import the settings.&quot;</span>),</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                      QStringList() &lt;&lt; tr(<span class="stringliteral">&quot;Review and Save&quot;</span>));</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;            <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                <span class="keywordflow">if</span> (importMngr-&gt;<a class="code" href="group___u_a_v_settings_import_export.html#ga6e52410598f9227184e55b40fc48df2a">importUAVSettings</a>(xmlDump, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    m_dialog.<a class="code" href="group___uploader.html#ga245cc1bb639b28a773705eb968b6b770">onStepChanged</a>(<a class="code" href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638ad3cbd49ec08e901cdc5e1f762d50a524">UpgradeAssistantDialog::STEP_DONE</a>);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">while</span> (!aborted) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        loop.exec();</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    upgraderActive = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;}</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onExportButtonClick()</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;{</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">if</span> (telMngr-&gt;<a class="code" href="group___u_a_v_talk_plugin.html#ga753148204d39c087c9aa27c9dbe9df98">isConnected</a>()) {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <span class="comment">/* select the UAV-oriented export thing */</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <a class="code" href="class_core_1_1_action_manager.html">Core::ActionManager</a> *am = <a class="code" href="group___core_plugin.html#ga71099762904aac0b404fcd1f93bdc83e">Core::ICore::instance</a>()-&gt;<a class="code" href="group___core_plugin.html#ga5e44e7795213bb2627acfa08a13f6a12">actionManager</a>();</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">if</span> (!am) {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            qWarning() &lt;&lt; <span class="stringliteral">&quot;Could not get ActionManager instance!&quot;</span>;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <a class="code" href="class_core_1_1_command.html">Core::Command</a> *cmd = am-&gt;<a class="code" href="group___core_plugin.html#ga262e29bf6a8d1cf1fb92dfe93b96621e">command</a>(<span class="stringliteral">&quot;UAVSettingsImportExportPlugin.UAVSettingsExport&quot;</span>);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">if</span> (cmd)</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            cmd-&gt;<a class="code" href="group___core_plugin.html#ga68bf6b0115ef45e9a734956f3b0d40c5">action</a>()-&gt;trigger();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            qWarning() &lt;&lt; <span class="stringliteral">&quot;Could find UAVSettingsExport action!&quot;</span>;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    }</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">/* make sure there&#39;s a setting partition */</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordflow">if</span> (!haveSettingsPart()) {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        QMessageBox msgBox;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        msgBox.setText(tr(<span class="stringliteral">&quot;No settings partition accessible; can&#39;t export.&quot;</span>));</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        msgBox.setInformativeText(tr(<span class="stringliteral">&quot;Please upgrade your bootloader.&quot;</span>));</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        msgBox.setStandardButtons(QMessageBox::Ok);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        msgBox.setDefaultButton(QMessageBox::Ok);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        msgBox.exec();</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="comment">/* get confirmation from user that using the cloud service is OK */</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    QMessageBox msgBox;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    msgBox.setText(tr(<span class="stringliteral">&quot;Do you wish to export the settings partition as an XML settings file?&quot;</span>));</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    msgBox.setInformativeText(tr(<span class="stringliteral">&quot;This will send the raw configuration information to a dRonin &quot;</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                                 <span class="stringliteral">&quot;cloud service for translation.&quot;</span>));</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    msgBox.setStandardButtons(QMessageBox::Yes | QMessageBox::No);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    msgBox.setDefaultButton(QMessageBox::Yes);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keywordtype">int</span> val = msgBox.exec();</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordflow">if</span> (val != QMessageBox::Yes) {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    }</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="comment">/* pull down settings partition to ram */</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">if</span> (!downloadSettings()) {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Error, unable to pull settings partition&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Retrieved settings; contacting cloud...&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    QString upgradingFrom = m_widget-&gt;gitHashOD_lbl-&gt;text();</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    QString ancestor = m_widget-&gt;ancestorHashOD_lbl-&gt;text();</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    tradeSettingsWithCloud(upgradingFrom, ancestor);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;}</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onBootloaderDetected()</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;{</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <a class="code" href="class_core_1_1_board_manager.html">Core::BoardManager</a> *brdMgr = <a class="code" href="group___core_plugin.html#ga71099762904aac0b404fcd1f93bdc83e">Core::ICore::instance</a>()-&gt;<a class="code" href="group___core_plugin.html#ga01532acba71e5af5bee3777209aebf7d">boardManager</a>();</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <a class="code" href="class_q_list.html">QList&lt;USBPortInfo&gt;</a> devices;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="comment">// If we are already connected to a bootloader, skip</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">if</span> (uploaderStatus == <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>) {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    }</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordflow">foreach</span> (<span class="keywordtype">int</span> vendorID, brdMgr-&gt;<a class="code" href="group___core_plugin.html#gaa37a0c8c804e3623c622cf8243bc7ef3">getKnownVendorIDs</a>()) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        devices.append(</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            <a class="code" href="group___raw_h_i_d_plugin.html#gabcb44085db71f0bd0a1513d25a572b33">USBMonitor::instance</a>()-&gt;availableDevices(vendorID, -1, -1, <a class="code" href="group___raw_h_i_d_plugin.html#ggaff6bf8945a7cdab907cf5adc29bec064afacf3dc002126ce1b351fe373583f8a3">USBMonitor::Upgrader</a>));</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        devices.append(</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            <a class="code" href="group___raw_h_i_d_plugin.html#gabcb44085db71f0bd0a1513d25a572b33">USBMonitor::instance</a>()-&gt;availableDevices(vendorID, -1, -1, <a class="code" href="group___raw_h_i_d_plugin.html#ggaff6bf8945a7cdab907cf5adc29bec064ac18f9b621b18e8d33c36467a92dd0dc9">USBMonitor::Bootloader</a>));</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">if</span> (devices.length() &gt; 1) {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;More than one device was detected in bootloader state&quot;</span>),</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                      <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a>);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="comment">// return;</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (devices.length() == 0) {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        setStatusInfo(<span class="stringliteral">&quot;No devices in bootloader state detected&quot;</span>, <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <a class="code" href="struct_u_s_b_port_info.html">USBPortInfo</a> device = devices.first();</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordtype">bool</span> triggerUpgrading = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordtype">bool</span> inUpgrader = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordtype">bool</span> validDescription = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordtype">bool</span> blankFC = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">if</span> (device.<a class="code" href="group___raw_h_i_d_plugin.html#gab6d916c34dedc4292a96af9d8abde7ea">getRunState</a>() == <a class="code" href="group___raw_h_i_d_plugin.html#ggaff6bf8945a7cdab907cf5adc29bec064afacf3dc002126ce1b351fe373583f8a3">USBMonitor::Upgrader</a>) {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        inUpgrader = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keywordflow">if</span> (dfu.OpenBootloaderComs(device)) {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <a class="code" href="structtl__dfu_1_1device.html">tl_dfu::device</a> dev = dfu.findCapabilities();</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        QByteArray description = dfu.DownloadDescriptionAsByteArray(dev.<a class="code" href="group___uploader.html#gaf447de9e4998d5ea65e26a28d08bd987">SizeOfDesc</a>);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        <a class="code" href="classdevice_descriptor_struct.html">deviceDescriptorStruct</a> descStructure;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="group___u_a_v_objects_plugin.html#ga31c6b739ad7f06472a3f3386e4bebd8a">UAVObjectUtilManager::descriptionToStructure</a>(description, descStructure))</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            setStatusInfo(tr(<span class="stringliteral">&quot;Could not parse firmware metadata&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a>);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            FirmwareOnDeviceUpdate(descStructure, QString::number((dev.<a class="code" href="group___uploader.html#gacf02ad92e4d0dda7432a2eb32bf9b271">FW_CRC</a>)));</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            validDescription = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <span class="keywordflow">if</span> (!inUpgrader) {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="keywordflow">switch</span> (uploaderStatus) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690abdbbfac16910eb802bf70df43588787e">uploader::UPGRADING</a>:</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                triggerUpgrading = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a9068a448064dd9c673d038228a0531da">uploader::UPGRADING_CATCHLOADER</a>:</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6490cdc12cc97adfcc89f39adda55807">uploader::ENTERING_LOADER</a>:</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>: {</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                <span class="comment">// look for completed bootloader update (last 2 chars of TlFw string are nulled)</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                <span class="keywordflow">if</span> (QString(description.left(4)) == <span class="stringliteral">&quot;Tl&quot;</span>)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                <span class="keywordflow">if</span> (validDescription) {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                    <span class="keywordflow">if</span> (FirmwareCheckForUpdate(descStructure)) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                        triggerUpgrading = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                    }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                    QMessageBox msgBox;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                    msgBox.setText(tr(<span class="stringliteral">&quot;There appears to be no valid firmware on your device..&quot;</span>));</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                    msgBox.setInformativeText(tr(<span class="stringliteral">&quot;Do you want to install firmware?&quot;</span>));</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                    msgBox.setStandardButtons(QMessageBox::Yes | QMessageBox::No);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                    msgBox.setDefaultButton(QMessageBox::Yes);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                    <span class="keywordtype">int</span> val = msgBox.exec();</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                    <span class="keywordflow">if</span> (val == QMessageBox::Yes) {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                        triggerUpgrading = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                        blankFC = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                    }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                    <span class="keywordflow">break</span>; <span class="comment">/* Don&#39;t boot in any case */</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                Q_FALLTHROUGH();</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                dfu.JumpToApp(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                dfu.CloseBootloaderComs();</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            }</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <span class="comment">// Bootloader has new cap extensions, query partitions and fill out browser</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">if</span> (dev.<a class="code" href="group___uploader.html#gaff993b6ff97d634dcd24b473b454258a">CapExt</a>) {</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            QTableWidgetItem *label;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            QTableWidgetItem *size;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            <span class="keywordtype">int</span> index = 0;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <span class="keywordtype">int</span> row_count = 0;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;            QString name;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            <span class="keywordflow">foreach</span> (<span class="keywordtype">int</span> <a class="code" href="_o_p_plots_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>, dev.<a class="code" href="group___uploader.html#ga5520e776ad3920f6a3cf5dbca46d9fb0">PartitionSizes</a>) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                <span class="keywordflow">if</span> (i &lt;= 0) {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                    <span class="comment">/* PartitionSizes is now sparse; there may be 0 sized parts</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">                     * in the middle.</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">                     */</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                    ++index;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                }</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                <span class="keywordflow">switch</span> (index) {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997fea21fd6b3ea09d1ff3bca44a7facf73e8e">DFU_PARTITION_FW</a>:</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                    name = <span class="stringliteral">&quot;Firmware&quot;</span>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997fea6a3d4ee0f00e71f903a165e9fbb10c93">DFU_PARTITION_DESC</a>:</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                    name = <span class="stringliteral">&quot;Metadata&quot;</span>;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997fea5722b7b547679e553019b9c3ec8a4d41">DFU_PARTITION_BL</a>:</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                    name = <span class="stringliteral">&quot;Bootloader&quot;</span>;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feaee07f6612e39b0d73a7314fe713e43e3">DFU_PARTITION_SETTINGS</a>:</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                    name = <span class="stringliteral">&quot;Settings&quot;</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feaa9ccdfeab9bd9abbc87bd62916f9eac3">DFU_PARTITION_AUTOTUNE</a>:</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                    name = <span class="stringliteral">&quot;AutoTune&quot;</span>;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feafc3a3c77089a4480a5c6b4e6a69d70a2">DFU_PARTITION_LOG</a>:</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                    name = <span class="stringliteral">&quot;Log&quot;</span>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feadac570fef1060ba6fb6c2f7f9a0ba23c">DFU_PARTITION_LOADABLE_EXTENSION</a>:</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                    name = <span class="stringliteral">&quot;Extension&quot;</span>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                    name = QString::number(index);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                label = <span class="keyword">new</span> QTableWidgetItem(name);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                size = <span class="keyword">new</span> QTableWidgetItem(QString::number(i));</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                label-&gt;setData(Qt::UserRole, index);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                size-&gt;setData(Qt::UserRole, index);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                size-&gt;setTextAlignment(Qt::AlignRight | Qt::AlignVCenter);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                m_widget-&gt;partitionBrowserTW-&gt;setRowCount(row_count + 1);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                m_widget-&gt;partitionBrowserTW-&gt;setItem(row_count, 0, label);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                m_widget-&gt;partitionBrowserTW-&gt;setItem(row_count, 1, size);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                ++index;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                ++row_count;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            }</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            m_widget-&gt;partitionBrowserGB-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            m_widget-&gt;partitionBrowserTW-&gt;setRowCount(0);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <a class="code" href="structdevice_info.html">deviceInfo</a> info;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        info.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a> = brdMgr-&gt;<a class="code" href="group___core_plugin.html#ga8c20a34ba137f0263f3d5d17e8193d24">getBoard</a>(dev.<a class="code" href="group___uploader.html#ga6dfbf5113f62a7d7f7c71c618744ea0d">ID</a> &gt;&gt; 8);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        <span class="keywordflow">if</span> (!info.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            setStatusInfo(tr(<span class="stringliteral">&quot;Board not supported!&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        }</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        info.<a class="code" href="structdevice_info.html#a11c0e01d0d01c04fb37571dfd72120a4">bl_version</a> = QString::number(dev.<a class="code" href="group___uploader.html#ga6f584609b0c34d0a6e9f4f25168bf901">BL_Version</a>, 16);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        info.<a class="code" href="structdevice_info.html#a4c7f3d6cd35d1cd5f8756075d915d704">cpu_serial</a> = <span class="stringliteral">&quot;Not Available&quot;</span>;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        info.<a class="code" href="structdevice_info.html#ac8171c63846102b491a666633b80aea4">hw_revision</a> = QString::number(dev.<a class="code" href="group___uploader.html#gaa726ecf0db7424f9980ac006267b6bbd">HW_Rev</a>);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        info.<a class="code" href="structdevice_info.html#afca090b1aeead1545be65b70fb65f05a">max_code_size</a> = QString::number(dev.<a class="code" href="group___uploader.html#gabd16f4e0796a41d99e70eaa2251c5767">SizeOfCode</a>);</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        DeviceInformationUpdate(info);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        iapUpdated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="keywordflow">if</span> (!inUpgrader) {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            setStatusInfo(tr(<span class="stringliteral">&quot;Connection to bootloader successful&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <span class="keywordflow">if</span> (FirmwareLoadFromFile(getImagePath(info.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;shortName()), &amp;loadedFile)) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                FirmwareLoadedClear(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                FirmwareLoadedUpdate(loadedFile);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                setStatusInfo(tr(<span class="stringliteral">&quot;Ready to flash firmware&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                this-&gt;activateWindow();</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                m_widget-&gt;flashButton-&gt;setFocus();</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            }</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            setStatusInfo(tr(<span class="stringliteral">&quot;Connected to upgrader-loader&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        <span class="keywordflow">if</span> (triggerUpgrading) {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            <span class="keywordflow">if</span> (currentBoard.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>) {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                <span class="keywordtype">bool</span> canBeUpgraded = currentBoard.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;queryCapabilities(</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                    <a class="code" href="group___core_plugin.html#gga01b09218f2a13aaeee6db007ac6bd967a5d21e0e40b21748b8af27ff489a76f03">Core::IBoardType::BOARD_CAPABILITIES_UPGRADEABLE</a>);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                <span class="keywordflow">if</span> (canBeUpgraded) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                    doUpgradeOperation(blankFC, dev);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            }</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        emit <a class="code" href="group___uploader.html#ga87d448f5964c57b1342f16f75bedc721">enteredLoader</a>();</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Could not open coms with the bootloader&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        setUploaderStatus((<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>));</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        conMngr-&gt;<a class="code" href="group___core_plugin.html#gaffc78d62ba1226c3d690158e30db4dee">resumePolling</a>();</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;}</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onBootloaderRemoved()</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;{</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    conMngr-&gt;<a class="code" href="group___core_plugin.html#gaffc78d62ba1226c3d690158e30db4dee">resumePolling</a>();</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Bootloader disconnection detected&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a>);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    DeviceInformationClear();</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    FirmwareOnDeviceClear(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    PartitionBrowserClear();</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keywordflow">if</span> (uploaderStatus != <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a9068a448064dd9c673d038228a0531da">uploader::UPGRADING_CATCHLOADER</a>) {</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    }</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;}</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::startRescue()</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;{</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    setStatusInfo(tr(<span class="stringliteral">&quot;Trying to detect bootloader&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a>);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    m_widget-&gt;progressBar-&gt;setValue(100);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    connect(&amp;rescueTimer, &amp;QTimer::timeout, <span class="keyword">this</span>, &amp;UploaderGadgetWidget::onRescueTimer,</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            Qt::UniqueConnection);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    rescueTimer.start(200);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    connect(usbFilterBL, &amp;<a class="code" href="group___raw_h_i_d_plugin.html#ga9d88c3bd1d000b31ad72af4735edaaf2">USBSignalFilter::deviceDiscovered</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            &amp;UploaderGadgetWidget::onDeviceDiscovered, Qt::UniqueConnection);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    connect(usbFilterUP, &amp;<a class="code" href="group___raw_h_i_d_plugin.html#ga9d88c3bd1d000b31ad72af4735edaaf2">USBSignalFilter::deviceDiscovered</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            &amp;UploaderGadgetWidget::onDeviceDiscovered, Qt::UniqueConnection);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;}</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onRescueTimer()</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;{</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    m_widget-&gt;progressBar-&gt;setValue(m_widget-&gt;progressBar-&gt;value() - 1);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keywordflow">if</span> (m_widget-&gt;progressBar-&gt;value() &lt;= 0) {</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        disconnect(usbFilterBL, &amp;<a class="code" href="group___raw_h_i_d_plugin.html#ga9d88c3bd1d000b31ad72af4735edaaf2">USBSignalFilter::deviceDiscovered</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                   &amp;UploaderGadgetWidget::onDeviceDiscovered);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        disconnect(usbFilterUP, &amp;<a class="code" href="group___raw_h_i_d_plugin.html#ga9d88c3bd1d000b31ad72af4735edaaf2">USBSignalFilter::deviceDiscovered</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                   &amp;UploaderGadgetWidget::onDeviceDiscovered);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        rescueTimer.disconnect();</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Failed to detect bootloader&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        conMngr-&gt;<a class="code" href="group___core_plugin.html#gaffc78d62ba1226c3d690158e30db4dee">resumePolling</a>();</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;}</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onDeviceDiscovered()</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;{</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    rescueTimer.stop();</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    m_widget-&gt;progressBar-&gt;setValue(0);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    disconnect(usbFilterBL, &amp;<a class="code" href="group___raw_h_i_d_plugin.html#ga9d88c3bd1d000b31ad72af4735edaaf2">USBSignalFilter::deviceDiscovered</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;               &amp;UploaderGadgetWidget::onDeviceDiscovered);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    disconnect(usbFilterUP, &amp;<a class="code" href="group___raw_h_i_d_plugin.html#ga9d88c3bd1d000b31ad72af4735edaaf2">USBSignalFilter::deviceDiscovered</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;               &amp;UploaderGadgetWidget::onDeviceDiscovered);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;}</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onStatusUpdate(QString text, <span class="keywordtype">int</span> progress)</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;{</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordflow">if</span> (!text.isEmpty())</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        setStatusInfo(text, <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308da13af96448b88ff31b53c18995e183a3f">uploader::STATUSICON_RUNNING</a>);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">if</span> (progress != -1)</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        m_widget-&gt;progressBar-&gt;setValue(progress);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;}</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::triggerPartitionDownload(<span class="keywordtype">int</span> index)</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;{</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">if</span> (!CheckInBootloaderState())</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <a class="code" href="structtl__dfu_1_1device.html">tl_dfu::device</a> dev = dfu.findCapabilities();</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordtype">int</span> size = dev.<a class="code" href="group___uploader.html#ga5520e776ad3920f6a3cf5dbca46d9fb0">PartitionSizes</a>[index];</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    setStatusInfo(<span class="stringliteral">&quot;&quot;</span>, <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308da13af96448b88ff31b53c18995e183a3f">uploader::STATUSICON_RUNNING</a>);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a71fc8eb4458bbae2d4773e7bd9209575">uploader::BL_BUSY</a>);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    tempArray.clear();</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    dfu.DownloadPartitionThreaded(&amp;tempArray, (<a class="code" href="group___uploader.html#ga7a55292dbba91b1d8a44bc6b127997fe">dfu_partition_label</a>)index, size);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;}</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onPartitionSave()</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;{</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keywordtype">int</span> index = m_widget-&gt;partitionBrowserTW-&gt;selectedItems().first()-&gt;data(Qt::UserRole).toInt();</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    QEventLoop loop;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordtype">bool</span> operationSuccess = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="comment">/* disconnects when loop comes out of scope */</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    connect(&amp;dfu, &amp;DFUObject::downloadFinished, &amp;loop, [&amp;](<span class="keywordtype">bool</span> status) {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        operationSuccess = status;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        loop.exit();</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    });</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    triggerPartitionDownload(index);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    loop.exec();</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordflow">if</span> (operationSuccess) {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Partition download success&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        QString filename =</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            QFileDialog::getSaveFileName(<span class="keyword">this</span>, tr(<span class="stringliteral">&quot;Save File&quot;</span>), QDir::homePath(), <span class="stringliteral">&quot;*.bin&quot;</span>);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        <span class="keywordflow">if</span> (filename.isEmpty()) {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;            setStatusInfo(tr(<span class="stringliteral">&quot;Save cancelled&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        <span class="keywordflow">if</span> (!filename.endsWith(<span class="stringliteral">&quot;.bin&quot;</span>, Qt::CaseInsensitive))</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            filename.append(<span class="stringliteral">&quot;.bin&quot;</span>);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        QFile <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>(filename);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.open(QIODevice::WriteOnly)) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.write(tempArray);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.close();</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            setStatusInfo(tr(<span class="stringliteral">&quot;Partition written to file&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            setStatusInfo(tr(<span class="stringliteral">&quot;Error could not open file for save&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Partition download failed&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;}</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onPartitionFlash()</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;{</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keywordflow">if</span> (!CheckInBootloaderState())</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    QString filename =</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        QFileDialog::getOpenFileName(<span class="keyword">this</span>, tr(<span class="stringliteral">&quot;Open File&quot;</span>), QDir::homePath(), <span class="stringliteral">&quot;*.bin&quot;</span>);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordflow">if</span> (filename.isEmpty()) {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Flash cancelled&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    }</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    QFile <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>(filename);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.open(QIODevice::ReadOnly)) {</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Could not open file for read&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    tempArray.clear();</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    tempArray = <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.readAll();</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="keywordtype">int</span> index = m_widget-&gt;partitionBrowserTW-&gt;selectedItems().first()-&gt;data(Qt::UserRole).toInt();</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <a class="code" href="structtl__dfu_1_1device.html">tl_dfu::device</a> dev = dfu.findCapabilities();</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordtype">int</span> size = dev.<a class="code" href="group___uploader.html#ga5520e776ad3920f6a3cf5dbca46d9fb0">PartitionSizes</a>[index];</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordflow">if</span> (tempArray.length() &gt; size) {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;File bigger than partition size&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    }</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordflow">if</span> (QMessageBox::warning(<span class="keyword">this</span>, tr(<span class="stringliteral">&quot;Warning&quot;</span>),</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                             tr(<span class="stringliteral">&quot;Are you sure you want to flash the selected partition?&quot;</span>),</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                             QMessageBox::Yes, QMessageBox::No)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        != QMessageBox::Yes)</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    setStatusInfo(<span class="stringliteral">&quot;&quot;</span>, <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308da13af96448b88ff31b53c18995e183a3f">uploader::STATUSICON_RUNNING</a>);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a71fc8eb4458bbae2d4773e7bd9209575">uploader::BL_BUSY</a>);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <a class="code" href="group___uploader.html#ga5668196b7ff4028f1f71803e9ff5c7c4">tl_dfu::Status</a> operationSuccess = <a class="code" href="group___uploader.html#gga5668196b7ff4028f1f71803e9ff5c7c4a563943e44f2724d6fd4f42d093712350">DFUidle</a>;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    QEventLoop loop;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="comment">/* disconnects when loop comes out of scope */</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    connect(&amp;dfu, &amp;DFUObject::uploadFinished, &amp;loop, [&amp;](<a class="code" href="group___uploader.html#ga5668196b7ff4028f1f71803e9ff5c7c4">tl_dfu::Status</a> status) {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        operationSuccess = status;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        loop.exit();</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    });</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    dfu.UploadPartitionThreaded(tempArray, (<a class="code" href="group___uploader.html#ga7a55292dbba91b1d8a44bc6b127997fe">dfu_partition_label</a>)index, size);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    loop.exec();</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">if</span> (operationSuccess == <a class="code" href="group___uploader.html#gga5668196b7ff4028f1f71803e9ff5c7c4a9e44395ad4ded84b53a90b8664d86947">Last_operation_Success</a>)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Partition upload success&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Partition upload failed&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    setUploaderStatus(<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;}</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onPartitionErase()</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;{</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keywordtype">int</span> index = m_widget-&gt;partitionBrowserTW-&gt;selectedItems().first()-&gt;data(Qt::UserRole).toInt();</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordflow">if</span> (QMessageBox::warning(<span class="keyword">this</span>, tr(<span class="stringliteral">&quot;Warning&quot;</span>),</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                             tr(<span class="stringliteral">&quot;Are you sure you want erase the selected partition?&quot;</span>),</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                             QMessageBox::Yes, QMessageBox::No)</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        != QMessageBox::Yes)</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">if</span> (dfu.WipePartition((<a class="code" href="group___uploader.html#ga7a55292dbba91b1d8a44bc6b127997fe">dfu_partition_label</a>)index))</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Partition erased&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Partition erasure failed&quot;</span>), <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;}</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::onBootButtonClick()</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;{</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="keywordtype">bool</span> safeboot = (sender() == m_widget-&gt;safeBootButton);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordflow">if</span> (telMngr-&gt;<a class="code" href="group___u_a_v_talk_plugin.html#ga753148204d39c087c9aa27c9dbe9df98">isConnected</a>()) {</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        haltOrReset(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordflow">if</span> (!CheckInBootloaderState())</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    dfu.JumpToApp(safeboot);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    dfu.CloseBootloaderComs();</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;}</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::CheckAutopilotReady()</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;{</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="keywordflow">if</span> (telemetryConnected &amp;&amp; iapUpdated) {</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        onAutopilotReady();</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;}</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="keywordtype">bool</span> UploaderGadgetWidget::CheckInBootloaderState()</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;{</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordflow">if</span> (uploaderStatus != <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>) {</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        setStatusInfo(tr(<span class="stringliteral">&quot;Cannot perform the selected operation if not in bootloader state&quot;</span>),</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                      <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;}</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;QString UploaderGadgetWidget::LoadFirmwareFileDialog(QString boardName)</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;{</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    QFileDialog::Options options;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    QString selectedFilter;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    boardName = boardName.toLower();</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    QString fwDirectoryStr = getImagePath(boardName);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    QString fileName = QFileDialog::getOpenFileName(</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <span class="keyword">this</span>, tr(<span class="stringliteral">&quot;Select firmware file&quot;</span>), fwDirectoryStr, tr(<span class="stringliteral">&quot;Firmware (fw_*.tlfw);;&quot;</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                                                             <span class="stringliteral">&quot;Bootloader Update (bu_*.tlfw);;&quot;</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                                                             <span class="stringliteral">&quot;All (*.tlfw *.opfw *.bin)&quot;</span>),</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        &amp;selectedFilter, options);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">return</span> fileName;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;}</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::setStatusInfo(QString str, <a class="code" href="group___uploader.html#ga769c7820b34912a5b82a8d29aa47308d">uploader::StatusIcon</a> ic)</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;{</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    qDebug() &lt;&lt; str;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    QPixmap px;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    m_widget-&gt;statusLabel-&gt;setText(str);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordflow">switch</span> (ic) {</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308da13af96448b88ff31b53c18995e183a3f">uploader::STATUSICON_RUNNING</a>:</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        px.load(QString(<span class="stringliteral">&quot;:/uploader/images/system-run.svg&quot;</span>));</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a>:</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        px.load(QString(<span class="stringliteral">&quot;:/uploader/images/dialog-apply.svg&quot;</span>));</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a>:</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        px.load(QString(<span class="stringliteral">&quot;:/uploader/images/process-stop.svg&quot;</span>));</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        px.load(QString(<span class="stringliteral">&quot;:/uploader/images/gtk-info.svg&quot;</span>));</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    m_widget-&gt;statusPic-&gt;setPixmap(px);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;}</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690">uploader::UploaderStatus</a> UploaderGadgetWidget::getUploaderStatus()<span class="keyword"> const</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="keywordflow">return</span> uploaderStatus;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;}</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="keywordtype">bool</span> UploaderGadgetWidget::haveSettingsPart()<span class="keyword"> const</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="comment">/* Would be nice to determine this in a nicer way */</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="keywordflow">if</span> (m_widget-&gt;partitionBrowserTW-&gt;rowCount() &gt;= <a class="code" href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feaee07f6612e39b0d73a7314fe713e43e3">DFU_PARTITION_SETTINGS</a>) {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    }</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;}</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::setUploaderStatus(<span class="keyword">const</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690">uploader::UploaderStatus</a> &amp;value)</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;{</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    uploaderStatus = value;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="keywordflow">switch</span> (uploaderStatus) {</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a>:</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        m_widget-&gt;progressBar-&gt;setVisible(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        m_widget-&gt;rescueButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        m_widget-&gt;rescueButton-&gt;setText(tr(<span class="stringliteral">&quot;Rescue&quot;</span>));</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        m_widget-&gt;bootButton-&gt;setText(tr(<span class="stringliteral">&quot;Boot&quot;</span>));</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        m_widget-&gt;openButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        m_widget-&gt;bootButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        m_widget-&gt;safeBootButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        m_widget-&gt;flashButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        m_widget-&gt;exportConfigButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        m_widget-&gt;partitionBrowserTW-&gt;setContextMenuPolicy(Qt::NoContextMenu);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6490cdc12cc97adfcc89f39adda55807">uploader::ENTERING_LOADER</a>:</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        m_widget-&gt;progressBar-&gt;setVisible(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        m_widget-&gt;rescueButton-&gt;setText(tr(<span class="stringliteral">&quot;Rescue&quot;</span>));</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        m_widget-&gt;bootButton-&gt;setText(tr(<span class="stringliteral">&quot;Boot&quot;</span>));</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        m_widget-&gt;rescueButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        m_widget-&gt;openButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        m_widget-&gt;bootButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        m_widget-&gt;safeBootButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        m_widget-&gt;flashButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        m_widget-&gt;exportConfigButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        m_widget-&gt;partitionBrowserTW-&gt;setContextMenuPolicy(Qt::NoContextMenu);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a>:</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        m_widget-&gt;progressBar-&gt;setVisible(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        m_widget-&gt;rescueButton-&gt;setText(tr(<span class="stringliteral">&quot;Rescue&quot;</span>));</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        m_widget-&gt;bootButton-&gt;setText(tr(<span class="stringliteral">&quot;Boot&quot;</span>));</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        m_widget-&gt;rescueButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        m_widget-&gt;openButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        m_widget-&gt;bootButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        m_widget-&gt;safeBootButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        <span class="keywordflow">if</span> (!loadedFile.isEmpty())</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            m_widget-&gt;flashButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            m_widget-&gt;flashButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        m_widget-&gt;exportConfigButton-&gt;setEnabled(haveSettingsPart());</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        m_widget-&gt;partitionBrowserTW-&gt;setContextMenuPolicy(Qt::ActionsContextMenu);</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6f34924bb42c3b036dedf26458bb370e">uploader::CONNECTED_TO_TELEMETRY</a>:</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        m_widget-&gt;progressBar-&gt;setVisible(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        m_widget-&gt;rescueButton-&gt;setText(tr(<span class="stringliteral">&quot;Enter bootloader&quot;</span>));</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        m_widget-&gt;bootButton-&gt;setText(tr(<span class="stringliteral">&quot;Reboot&quot;</span>));</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        m_widget-&gt;rescueButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        m_widget-&gt;openButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        m_widget-&gt;bootButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        m_widget-&gt;safeBootButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        m_widget-&gt;flashButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        m_widget-&gt;exportConfigButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        m_widget-&gt;partitionBrowserTW-&gt;setContextMenuPolicy(Qt::NoContextMenu);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690abdbbfac16910eb802bf70df43588787e">uploader::UPGRADING</a>:</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a9068a448064dd9c673d038228a0531da">uploader::UPGRADING_CATCHLOADER</a>:</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a71fc8eb4458bbae2d4773e7bd9209575">uploader::BL_BUSY</a>:</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        m_widget-&gt;progressBar-&gt;setVisible(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        m_widget-&gt;rescueButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        m_widget-&gt;openButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        m_widget-&gt;bootButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        m_widget-&gt;safeBootButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        m_widget-&gt;flashButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        m_widget-&gt;exportConfigButton-&gt;setEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        m_widget-&gt;partitionBrowserTW-&gt;setContextMenuPolicy(Qt::NoContextMenu);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    }</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;}</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="keywordtype">void</span> UploaderGadgetWidget::openHelp()</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;{</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    QDesktopServices::openUrl(QUrl(</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <span class="stringliteral">&quot;https://github.com/d-ronin/dRonin/wiki/OnlineHelp:-Uploader-Plugin&quot;</span>, QUrl::StrictMode));</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;}</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;QString UploaderGadgetWidget::getImagePath(QString boardName, QString imageType)</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;{</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    QString imageName = QString(<span class="stringliteral">&quot;%1_%2&quot;</span>).arg(imageType).arg(boardName.toLower());</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    QString imageNameWithSuffix = QString(<span class="stringliteral">&quot;%1.tlfw&quot;</span>).arg(imageName);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    QStringList paths = QStringList()</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="comment">/* Relative paths first; try in application bundle or build dir */</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> <span class="comment">// uh, right here?</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;../firmware&quot;</span> <span class="comment">// windows installed path</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <span class="comment">/* Added ../build to these to make sure our assumptions are right</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment">         * about it being a build tree */</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;../../../../build&quot;</span> <span class="comment">// windows / linux build</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;../../../../../../../build&quot;</span> <span class="comment">// OSX build</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;../Resources/firmware&quot;</span> <span class="comment">// OSX app bundle</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;/usr/local/&quot;</span> GCS_PROJECT_BRANDING_PRETTY <span class="stringliteral">&quot;/firmware&quot;</span>; <span class="comment">// leenucks deb</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="keywordflow">foreach</span> (QString path, paths) {</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        QDir pathDir = QDir(QCoreApplication::applicationDirPath());</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        <span class="keywordflow">if</span> (pathDir.cd(path)) {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;            <span class="comment">/* Two things to try. */</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;            QString perTargetPath = QString(<span class="stringliteral">&quot;%1/%2/%3&quot;</span>)</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                                        .arg(pathDir.absolutePath())</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                                        .arg(imageName)</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                                        .arg(imageNameWithSuffix);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <span class="keywordflow">if</span> (QFile::exists(perTargetPath)) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                <span class="keywordflow">return</span> perTargetPath;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;            }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            QString directPath =</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                QString(<span class="stringliteral">&quot;%1/%2&quot;</span>).arg(pathDir.absolutePath()).arg(imageNameWithSuffix);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            <span class="keywordflow">if</span> (QFile::exists(directPath)) {</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                <span class="keywordflow">return</span> directPath;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            }</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        }</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="comment">/* This is sane for file dialogs, too. */</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordflow">return</span> QString(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;}</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="keywordtype">bool</span> UploaderGadgetWidget::FirmwareLoadFromFile(QString filename, QByteArray *contents)</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;{</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    QFileInfo fileinfo = QFileInfo(filename);</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="keywordflow">if</span> (!fileinfo.exists())</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    QFile <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>(fileinfo.filePath());</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.open(QIODevice::ReadOnly))</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    *contents = <a class="code" href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a>.readAll();</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;}</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="keywordtype">bool</span> UploaderGadgetWidget::FirmwareCheckForUpdate(<a class="code" href="classdevice_descriptor_struct.html">deviceDescriptorStruct</a> device)</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;{</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="keywordflow">if</span> (currentBoard.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>) {</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <span class="keywordtype">bool</span> canBeUpgraded =</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            currentBoard.<a class="code" href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">board</a>-&gt;queryCapabilities(<a class="code" href="group___core_plugin.html#gga01b09218f2a13aaeee6db007ac6bd967a5d21e0e40b21748b8af27ff489a76f03">Core::IBoardType::BOARD_CAPABILITIES_UPGRADEABLE</a>);</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="keywordflow">if</span> (!canBeUpgraded) {</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        }</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    }</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="keyword">const</span> QString gcsRev(GCS_REVISION);</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="keywordflow">if</span> (gcsRev.contains(<span class="charliteral">&#39;:&#39;</span>)) {</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        QString gcsShort = gcsRev.mid(gcsRev.indexOf(<span class="charliteral">&#39;:&#39;</span>) + 1, 8);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        <span class="keywordflow">if</span> ((gcsShort != device.<a class="code" href="group___u_a_v_object_util_plugin.html#ga7c265729bc1bc959e63a3c8f0f1543e8">gitHash</a>) &amp;&amp; (ignoredRev != device.<a class="code" href="group___u_a_v_object_util_plugin.html#ga7c265729bc1bc959e63a3c8f0f1543e8">gitHash</a>)) {</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            QMessageBox msgBox;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            msgBox.setText(</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                tr(<span class="stringliteral">&quot;The firmware version on your board does not match this version of GCS.&quot;</span>));</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            msgBox.setInformativeText(</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                tr(<span class="stringliteral">&quot;Do you want to upgrade the firmware to a compatible version?&quot;</span>));</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            msgBox.setDetailedText(QString(<span class="stringliteral">&quot;Firmware git hash: %1\nGCS git hash: %2&quot;</span>)</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                                       .arg(device.<a class="code" href="group___u_a_v_object_util_plugin.html#ga7c265729bc1bc959e63a3c8f0f1543e8">gitHash</a>)</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                                       .arg(gcsShort));</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;            msgBox.setStandardButtons(QMessageBox::Yes | QMessageBox::Ignore);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;            msgBox.setDefaultButton(QMessageBox::Yes);</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            <span class="keywordtype">int</span> val = msgBox.exec();</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;            <span class="keywordflow">if</span> (val == QMessageBox::Yes)</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (val == QMessageBox::Ignore)</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                ignoredRev = device.<a class="code" href="group___u_a_v_object_util_plugin.html#ga7c265729bc1bc959e63a3c8f0f1543e8">gitHash</a>;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        }</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    }</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;}</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div>
<div class="line"><a name="l02024"></a><span class="lineno"><a class="line" href="group___uploader.html#ga5040dcbf920da570c74a486743231d5d"> 2024</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group___uploader.html#ga5040dcbf920da570c74a486743231d5d">UploaderGadgetWidget::active</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordflow">switch</span> (uploaderStatus) {</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">DISCONNECTED</a>:</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6f34924bb42c3b036dedf26458bb370e">CONNECTED_TO_TELEMETRY</a>:</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        <span class="keywordflow">return</span> upgraderActive;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6490cdc12cc97adfcc89f39adda55807">ENTERING_LOADER</a>:</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">BL_SITTING</a>:</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a71fc8eb4458bbae2d4773e7bd9209575">BL_BUSY</a>:</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690abdbbfac16910eb802bf70df43588787e">UPGRADING</a>:</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a9068a448064dd9c673d038228a0531da">UPGRADING_CATCHLOADER</a>:</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    }</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;}</div>
<div class="ttc" id="group___uploader_html_ga77a98a88ccfc2d6f0236ec9e053da638"><div class="ttname"><a href="group___uploader.html#ga77a98a88ccfc2d6f0236ec9e053da638">UpgradeAssistantDialog::UpgradeAssistantStep</a></div><div class="ttdeci">UpgradeAssistantStep</div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00046">upgradeassistantdialog.h:46</a></div></div>
<div class="ttc" id="group___u_a_v_settings_import_export_html_ga6e52410598f9227184e55b40fc48df2a"><div class="ttname"><a href="group___u_a_v_settings_import_export.html#ga6e52410598f9227184e55b40fc48df2a">UAVSettingsImportExportManager::importUAVSettings</a></div><div class="ttdeci">bool importUAVSettings(const QByteArray &amp;settings, bool quiet=false)</div><div class="ttdef"><b>Definition:</b> <a href="uavsettingsimportexportmanager_8cpp_source.html#l00110">uavsettingsimportexportmanager.cpp:110</a></div></div>
<div class="ttc" id="group___uploader_html_gaea10e87c01ae547b8a9ebdd37e45d399"><div class="ttname"><a href="group___uploader.html#gaea10e87c01ae547b8a9ebdd37e45d399">UpgradeAssistantDialog::PromptUser</a></div><div class="ttdeci">int PromptUser(QString promptText, QString detailText, QStringList buttonText)</div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8cpp_source.html#l00078">upgradeassistantdialog.cpp:78</a></div></div>
<div class="ttc" id="group___uploader_html_ga39018319f1ee8c5732861b209b79e747"><div class="ttname"><a href="group___uploader.html#ga39018319f1ee8c5732861b209b79e747">uploader::UploaderGadgetWidget::newBoardSeen</a></div><div class="ttdeci">void newBoardSeen(deviceInfo board, deviceDescriptorStruct device)</div></div>
<div class="ttc" id="group___uploader_html_ga6f584609b0c34d0a6e9f4f25168bf901"><div class="ttname"><a href="group___uploader.html#ga6f584609b0c34d0a6e9f4f25168bf901">tl_dfu::device::BL_Version</a></div><div class="ttdeci">quint8 BL_Version</div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00066">tl_dfu.h:66</a></div></div>
<div class="ttc" id="group___uploader_html_ga5804d2fb896816a6c1a7be7ca7774242"><div class="ttname"><a href="group___uploader.html#ga5804d2fb896816a6c1a7be7ca7774242">tl_dfu::DFUObject::operationProgress</a></div><div class="ttdeci">void operationProgress(QString status, int progress)</div></div>
<div class="ttc" id="class_core_1_1_i_connection_html"><div class="ttname"><a href="class_core_1_1_i_connection.html">Core::IConnection</a></div><div class="ttdef"><b>Definition:</b> <a href="iconnection_8h_source.html#l00044">iconnection.h:44</a></div></div>
<div class="ttc" id="rawhidplugin_8h_html"><div class="ttname"><a href="rawhidplugin_8h.html">rawhidplugin.h</a></div></div>
<div class="ttc" id="group___u_a_v_object_util_plugin_html_ga2a96c0269c09447e493055692fd68ad5"><div class="ttname"><a href="group___u_a_v_object_util_plugin.html#ga2a96c0269c09447e493055692fd68ad5">deviceDescriptorStruct::boardType</a></div><div class="ttdeci">quint8 boardType</div><div class="ttdef"><b>Definition:</b> <a href="devicedescriptorstruct_8h_source.html#l00044">devicedescriptorstruct.h:44</a></div></div>
<div class="ttc" id="group___uploader_html_gga77a98a88ccfc2d6f0236ec9e053da638a9ddebf132c47f8d9e2e2177c0f75f817"><div class="ttname"><a href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a9ddebf132c47f8d9e2e2177c0f75f817">UpgradeAssistantDialog::STEP_IMPORT</a></div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00056">upgradeassistantdialog.h:56</a></div></div>
<div class="ttc" id="group___uploader_html_gga77a98a88ccfc2d6f0236ec9e053da638a07c67d2e649a55c2dabbcd17434ffc1f"><div class="ttname"><a href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a07c67d2e649a55c2dabbcd17434ffc1f">UpgradeAssistantDialog::STEP_UPGRADEBOOTLOADER</a></div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00050">upgradeassistantdialog.h:50</a></div></div>
<div class="ttc" id="group___raw_h_i_d_plugin_html_ggaff6bf8945a7cdab907cf5adc29bec064afacf3dc002126ce1b351fe373583f8a3"><div class="ttname"><a href="group___raw_h_i_d_plugin.html#ggaff6bf8945a7cdab907cf5adc29bec064afacf3dc002126ce1b351fe373583f8a3">USBMonitor::Upgrader</a></div><div class="ttdef"><b>Definition:</b> <a href="usbmonitor_8h_source.html#l00093">usbmonitor.h:93</a></div></div>
<div class="ttc" id="group___core_plugin_html_ga756ec59f5104cce0abf8a6990a2bba2c"><div class="ttname"><a href="group___core_plugin.html#ga756ec59f5104cce0abf8a6990a2bba2c">Core::ModeManager::instance</a></div><div class="ttdeci">static ModeManager * instance()</div><div class="ttdef"><b>Definition:</b> <a href="modemanager_8h_source.html#l00062">modemanager.h:62</a></div></div>
<div class="ttc" id="group___uploader_html_gaf447de9e4998d5ea65e26a28d08bd987"><div class="ttname"><a href="group___uploader.html#gaf447de9e4998d5ea65e26a28d08bd987">tl_dfu::device::SizeOfDesc</a></div><div class="ttdeci">int SizeOfDesc</div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00067">tl_dfu.h:67</a></div></div>
<div class="ttc" id="group___uploader_html_gabd16f4e0796a41d99e70eaa2251c5767"><div class="ttname"><a href="group___uploader.html#gabd16f4e0796a41d99e70eaa2251c5767">tl_dfu::device::SizeOfCode</a></div><div class="ttdeci">quint32 SizeOfCode</div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00068">tl_dfu.h:68</a></div></div>
<div class="ttc" id="pluginmanager_8h_html"><div class="ttname"><a href="pluginmanager_8h.html">pluginmanager.h</a></div></div>
<div class="ttc" id="group___uploader_html_gga769c7820b34912a5b82a8d29aa47308da13af96448b88ff31b53c18995e183a3f"><div class="ttname"><a href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308da13af96448b88ff31b53c18995e183a3f">uploader::STATUSICON_RUNNING</a></div><div class="ttdef"><b>Definition:</b> <a href="uploadergadgetwidget_8h_source.html#l00053">uploadergadgetwidget.h:53</a></div></div>
<div class="ttc" id="group___core_plugin_html_ga68bf6b0115ef45e9a734956f3b0d40c5"><div class="ttname"><a href="group___core_plugin.html#ga68bf6b0115ef45e9a734956f3b0d40c5">Core::Command::action</a></div><div class="ttdeci">virtual QAction * action() const =0</div></div>
<div class="ttc" id="namespaceuploader_html_aae5cd9d9abc36fb9bb59f55a29f5f690"><div class="ttname"><a href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690">uploader::UploaderStatus</a></div><div class="ttdeci">UploaderStatus</div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00036">uploader_global.h:36</a></div></div>
<div class="ttc" id="namespaceuploader_html_aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40"><div class="ttname"><a href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690acb69c2963ad1d6ea453e46e48b68ab40">uploader::DISCONNECTED</a></div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00037">uploader_global.h:37</a></div></div>
<div class="ttc" id="group___core_plugin_html_gaa37a0c8c804e3623c622cf8243bc7ef3"><div class="ttname"><a href="group___core_plugin.html#gaa37a0c8c804e3623c622cf8243bc7ef3">Core::BoardManager::getKnownVendorIDs</a></div><div class="ttdeci">QList&lt; int &gt; getKnownVendorIDs()</div><div class="ttdoc">getKnownVendorIDs Get all USB VendorIDs known by the board manager. This can be used by any plugin wh...</div><div class="ttdef"><b>Definition:</b> <a href="boardmanager_8cpp_source.html#l00076">boardmanager.cpp:76</a></div></div>
<div class="ttc" id="group___uploader_html_gga77a98a88ccfc2d6f0236ec9e053da638a53a7b75423c01453fe089ae707271189"><div class="ttname"><a href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a53a7b75423c01453fe089ae707271189">UpgradeAssistantDialog::STEP_BOOT</a></div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00055">upgradeassistantdialog.h:55</a></div></div>
<div class="ttc" id="group___uploader_html_gga77a98a88ccfc2d6f0236ec9e053da638ad3cbd49ec08e901cdc5e1f762d50a524"><div class="ttname"><a href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638ad3cbd49ec08e901cdc5e1f762d50a524">UpgradeAssistantDialog::STEP_DONE</a></div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00057">upgradeassistantdialog.h:57</a></div></div>
<div class="ttc" id="namespaceuploader_html_aae5cd9d9abc36fb9bb59f55a29f5f690abdbbfac16910eb802bf70df43588787e"><div class="ttname"><a href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690abdbbfac16910eb802bf70df43588787e">uploader::UPGRADING</a></div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00042">uploader_global.h:42</a></div></div>
<div class="ttc" id="group___uploader_html_gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350"><div class="ttname"><a href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308daed4e66e1c35899adda386f9f4cef9350">uploader::STATUSICON_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="uploadergadgetwidget_8h_source.html#l00053">uploadergadgetwidget.h:53</a></div></div>
<div class="ttc" id="namespaceuploader_html_aae5cd9d9abc36fb9bb59f55a29f5f690a71fc8eb4458bbae2d4773e7bd9209575"><div class="ttname"><a href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a71fc8eb4458bbae2d4773e7bd9209575">uploader::BL_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00040">uploader_global.h:40</a></div></div>
<div class="ttc" id="structdevice_info_html_a11c0e01d0d01c04fb37571dfd72120a4"><div class="ttname"><a href="structdevice_info.html#a11c0e01d0d01c04fb37571dfd72120a4">deviceInfo::bl_version</a></div><div class="ttdeci">QString bl_version</div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00049">uploader_global.h:49</a></div></div>
<div class="ttc" id="group___uploader_html_gacf02ad92e4d0dda7432a2eb32bf9b271"><div class="ttname"><a href="group___uploader.html#gacf02ad92e4d0dda7432a2eb32bf9b271">tl_dfu::device::FW_CRC</a></div><div class="ttdeci">quint32 FW_CRC</div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00065">tl_dfu.h:65</a></div></div>
<div class="ttc" id="group___uploader_html_ga769c7820b34912a5b82a8d29aa47308d"><div class="ttname"><a href="group___uploader.html#ga769c7820b34912a5b82a8d29aa47308d">uploader::StatusIcon</a></div><div class="ttdeci">StatusIcon</div><div class="ttdef"><b>Definition:</b> <a href="uploadergadgetwidget_8h_source.html#l00053">uploadergadgetwidget.h:53</a></div></div>
<div class="ttc" id="group___uploader_html_gaff993b6ff97d634dcd24b473b454258a"><div class="ttname"><a href="group___uploader.html#gaff993b6ff97d634dcd24b473b454258a">tl_dfu::device::CapExt</a></div><div class="ttdeci">bool CapExt</div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00073">tl_dfu.h:73</a></div></div>
<div class="ttc" id="actionmanager_8h_html"><div class="ttname"><a href="actionmanager_8h.html">actionmanager.h</a></div></div>
<div class="ttc" id="class_core_1_1_board_manager_html"><div class="ttname"><a href="class_core_1_1_board_manager.html">Core::BoardManager</a></div><div class="ttdef"><b>Definition:</b> <a href="boardmanager_8h_source.html#l00037">boardmanager.h:37</a></div></div>
<div class="ttc" id="group___core_plugin_html_ga5e44e7795213bb2627acfa08a13f6a12"><div class="ttname"><a href="group___core_plugin.html#ga5e44e7795213bb2627acfa08a13f6a12">Core::ICore::actionManager</a></div><div class="ttdeci">virtual ActionManager * actionManager() const =0</div><div class="ttdoc">Returns the application&#39;s action manager. </div></div>
<div class="ttc" id="_o_p_plots_8m_html_a6f6ccfcf58b31cb6412107d9d5281426"><div class="ttname"><a href="_o_p_plots_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></div><div class="ttdeci">for i</div><div class="ttdef"><b>Definition:</b> <a href="_o_p_plots_8m_source.html#l00140">OPPlots.m:140</a></div></div>
<div class="ttc" id="class_telemetry_manager_html"><div class="ttname"><a href="class_telemetry_manager.html">TelemetryManager</a></div><div class="ttdef"><b>Definition:</b> <a href="telemetrymanager_8h_source.html#l00041">telemetrymanager.h:41</a></div></div>
<div class="ttc" id="group___uploader_html_gga7a55292dbba91b1d8a44bc6b127997fea21fd6b3ea09d1ff3bca44a7facf73e8e"><div class="ttname"><a href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997fea21fd6b3ea09d1ff3bca44a7facf73e8e">tl_dfu::DFU_PARTITION_FW</a></div><div class="ttdef"><b>Definition:</b> <a href="bl__messages_8h_source.html#l00097">bl_messages.h:97</a></div></div>
<div class="ttc" id="group___core_plugin_html_ga93568acf4b301c44a1d9bf243066f3ff"><div class="ttname"><a href="group___core_plugin.html#ga93568acf4b301c44a1d9bf243066f3ff">Core::ConnectionManager::getCurrentDevice</a></div><div class="ttdeci">DevListItem getCurrentDevice()</div><div class="ttdef"><b>Definition:</b> <a href="connectionmanager_8h_source.html#l00111">connectionmanager.h:111</a></div></div>
<div class="ttc" id="namespaceuploader_html_aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f"><div class="ttname"><a href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a82f99896fbb0858cbbfe3b92a01eca7f">uploader::BL_SITTING</a></div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00039">uploader_global.h:39</a></div></div>
<div class="ttc" id="group___uploader_html_ga81ab4c8e328f917680b38093e9c69e6c"><div class="ttname"><a href="group___uploader.html#ga81ab4c8e328f917680b38093e9c69e6c">uploader::UploaderGadgetWidget::~UploaderGadgetWidget</a></div><div class="ttdeci">~UploaderGadgetWidget()</div><div class="ttdoc">Class destructor, nothing needs to be destructed ATM. </div><div class="ttdef"><b>Definition:</b> <a href="uploadergadgetwidget_8cpp_source.html#l00170">uploadergadgetwidget.cpp:170</a></div></div>
<div class="ttc" id="structdevice_info_html_afca090b1aeead1545be65b70fb65f05a"><div class="ttname"><a href="structdevice_info.html#afca090b1aeead1545be65b70fb65f05a">deviceInfo::max_code_size</a></div><div class="ttdeci">QString max_code_size</div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00050">uploader_global.h:50</a></div></div>
<div class="ttc" id="group___uploader_html_gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2"><div class="ttname"><a href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dabd6d1a4a2f86959c7bf6e8f7f55d09d2">uploader::STATUSICON_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="uploadergadgetwidget_8h_source.html#l00053">uploadergadgetwidget.h:53</a></div></div>
<div class="ttc" id="group___core_plugin_html_gab606d10ae8f0f9575d0e8ffb6e776ac7"><div class="ttname"><a href="group___core_plugin.html#gab606d10ae8f0f9575d0e8ffb6e776ac7">Core::ICore::connectionManager</a></div><div class="ttdeci">virtual ConnectionManager * connectionManager() const =0</div></div>
<div class="ttc" id="group___u_a_v_object_util_plugin_html_ga69f44ea76d04a61aac18e4393eba4e84"><div class="ttname"><a href="group___u_a_v_object_util_plugin.html#ga69f44ea76d04a61aac18e4393eba4e84">deviceDescriptorStruct::gitTag</a></div><div class="ttdeci">QString gitTag</div><div class="ttdef"><b>Definition:</b> <a href="devicedescriptorstruct_8h_source.html#l00039">devicedescriptorstruct.h:39</a></div></div>
<div class="ttc" id="group___u_a_v_objects_plugin_html_ga9aac3ae5395f63249cd821e0e5be5bf2"><div class="ttname"><a href="group___u_a_v_objects_plugin.html#ga9aac3ae5395f63249cd821e0e5be5bf2">UAVObject::objectUpdated</a></div><div class="ttdeci">void objectUpdated(UAVObject *obj)</div><div class="ttdoc">Signal sent whenever any field of the object is updated. </div></div>
<div class="ttc" id="group___core_plugin_html_gga01b09218f2a13aaeee6db007ac6bd967a5d21e0e40b21748b8af27ff489a76f03"><div class="ttname"><a href="group___core_plugin.html#gga01b09218f2a13aaeee6db007ac6bd967a5d21e0e40b21748b8af27ff489a76f03">Core::IBoardType::BOARD_CAPABILITIES_UPGRADEABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="iboardtype_8h_source.html#l00099">iboardtype.h:99</a></div></div>
<div class="ttc" id="group___uploader_html_ga5040dcbf920da570c74a486743231d5d"><div class="ttname"><a href="group___uploader.html#ga5040dcbf920da570c74a486743231d5d">uploader::UploaderGadgetWidget::active</a></div><div class="ttdeci">bool active() const </div><div class="ttdoc">active </div><div class="ttdef"><b>Definition:</b> <a href="uploadergadgetwidget_8cpp_source.html#l02024">uploadergadgetwidget.cpp:2024</a></div></div>
<div class="ttc" id="group___uploader_html_gga7a55292dbba91b1d8a44bc6b127997feaa9ccdfeab9bd9abbc87bd62916f9eac3"><div class="ttname"><a href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feaa9ccdfeab9bd9abbc87bd62916f9eac3">tl_dfu::DFU_PARTITION_AUTOTUNE</a></div><div class="ttdef"><b>Definition:</b> <a href="bl__messages_8h_source.html#l00101">bl_messages.h:101</a></div></div>
<div class="ttc" id="icore_8h_html"><div class="ttname"><a href="icore_8h.html">icore.h</a></div></div>
<div class="ttc" id="group___core_plugin_html_ga262e29bf6a8d1cf1fb92dfe93b96621e"><div class="ttname"><a href="group___core_plugin.html#ga262e29bf6a8d1cf1fb92dfe93b96621e">Core::ActionManager::command</a></div><div class="ttdeci">virtual Command * command(const QString &amp;id) const =0</div><div class="ttdoc">Returns the Command object that is known to the system under the given string id. ...</div></div>
<div class="ttc" id="group___uploader_html_ga7a55292dbba91b1d8a44bc6b127997fe"><div class="ttname"><a href="group___uploader.html#ga7a55292dbba91b1d8a44bc6b127997fe">tl_dfu::dfu_partition_label</a></div><div class="ttdeci">dfu_partition_label</div><div class="ttdef"><b>Definition:</b> <a href="bl__messages_8h_source.html#l00096">bl_messages.h:96</a></div></div>
<div class="ttc" id="uavobjecttemplate_8m_html_a97c04efa65bcf0928abf9260bc5cbf46"><div class="ttname"><a href="uavobjecttemplate_8m.html#a97c04efa65bcf0928abf9260bc5cbf46">file</a></div><div class="ttdeci">Parse log file</div><div class="ttdef"><b>Definition:</b> <a href="uavobjecttemplate_8m_source.html#l00107">uavobjecttemplate.m:107</a></div></div>
<div class="ttc" id="class_u_a_v_settings_import_export_manager_html"><div class="ttname"><a href="class_u_a_v_settings_import_export_manager.html">UAVSettingsImportExportManager</a></div><div class="ttdef"><b>Definition:</b> <a href="uavsettingsimportexportmanager_8h_source.html#l00039">uavsettingsimportexportmanager.h:39</a></div></div>
<div class="ttc" id="group___u_a_v_object_util_plugin_html_gad367094e97afa14f347d454771e71642"><div class="ttname"><a href="group___u_a_v_object_util_plugin.html#gad367094e97afa14f347d454771e71642">deviceDescriptorStruct::nextAncestor</a></div><div class="ttdeci">QString nextAncestor</div><div class="ttdef"><b>Definition:</b> <a href="devicedescriptorstruct_8h_source.html#l00041">devicedescriptorstruct.h:41</a></div></div>
<div class="ttc" id="group___u_a_v_object_util_plugin_html_gae920502ccf0fd693241d0d4b93dfc535"><div class="ttname"><a href="group___u_a_v_object_util_plugin.html#gae920502ccf0fd693241d0d4b93dfc535">deviceDescriptorStruct::boardID</a></div><div class="ttdeci">quint16 boardID()</div><div class="ttdef"><b>Definition:</b> <a href="devicedescriptorstruct_8cpp_source.html#l00037">devicedescriptorstruct.cpp:37</a></div></div>
<div class="ttc" id="group___core_plugin_html_gadd4b3b24c51d0993e61aab8ee9e76f48"><div class="ttname"><a href="group___core_plugin.html#gadd4b3b24c51d0993e61aab8ee9e76f48">Core::ModeManager::activateModeByWorkspaceName</a></div><div class="ttdeci">void activateModeByWorkspaceName(const QString &amp;id)</div><div class="ttdef"><b>Definition:</b> <a href="modemanager_8cpp_source.html#l00128">modemanager.cpp:128</a></div></div>
<div class="ttc" id="group___core_plugin_html_ga679b06064b497205af5453783acff419"><div class="ttname"><a href="group___core_plugin.html#ga679b06064b497205af5453783acff419">Core::ConnectionManager::disconnectDevice</a></div><div class="ttdeci">bool disconnectDevice()</div><div class="ttdef"><b>Definition:</b> <a href="connectionmanager_8cpp_source.html#l00177">connectionmanager.cpp:177</a></div></div>
<div class="ttc" id="group___uploader_html_ga5668196b7ff4028f1f71803e9ff5c7c4"><div class="ttname"><a href="group___uploader.html#ga5668196b7ff4028f1f71803e9ff5c7c4">tl_dfu::Status</a></div><div class="ttdeci">Status</div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00044">tl_dfu.h:44</a></div></div>
<div class="ttc" id="group___uploader_html_gga77a98a88ccfc2d6f0236ec9e053da638a854ed60a3846f938d6db376e0f3b3cff"><div class="ttname"><a href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a854ed60a3846f938d6db376e0f3b3cff">UpgradeAssistantDialog::STEP_DOWNLOADSETTINGS</a></div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00051">upgradeassistantdialog.h:51</a></div></div>
<div class="ttc" id="group___uploader_html_ga523a8cbb5c228bfb1678274a09c4b91d"><div class="ttname"><a href="group___uploader.html#ga523a8cbb5c228bfb1678274a09c4b91d">UpgradeAssistantDialog::setOperatingMode</a></div><div class="ttdeci">void setOperatingMode(bool upgradingBootloader, bool blankFC)</div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8cpp_source.html#l00067">upgradeassistantdialog.cpp:67</a></div></div>
<div class="ttc" id="group___u_a_v_object_util_plugin_html_gaa4639a6c66d44d1f5e0bf6c22c5eec64"><div class="ttname"><a href="group___u_a_v_object_util_plugin.html#gaa4639a6c66d44d1f5e0bf6c22c5eec64">deviceDescriptorStruct::uavoHash</a></div><div class="ttdeci">QByteArray uavoHash</div><div class="ttdef"><b>Definition:</b> <a href="devicedescriptorstruct_8h_source.html#l00043">devicedescriptorstruct.h:43</a></div></div>
<div class="ttc" id="group___core_plugin_html_ga71099762904aac0b404fcd1f93bdc83e"><div class="ttname"><a href="group___core_plugin.html#ga71099762904aac0b404fcd1f93bdc83e">Core::ICore::instance</a></div><div class="ttdeci">static ICore * instance()</div><div class="ttdef"><b>Definition:</b> <a href="coreimpl_8cpp_source.html#l00046">coreimpl.cpp:46</a></div></div>
<div class="ttc" id="structdevice_info_html"><div class="ttname"><a href="structdevice_info.html">deviceInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00046">uploader_global.h:46</a></div></div>
<div class="ttc" id="class_u_a_v_object_util_manager_html"><div class="ttname"><a href="class_u_a_v_object_util_manager.html">UAVObjectUtilManager</a></div><div class="ttdef"><b>Definition:</b> <a href="uavobjectutilmanager_8h_source.html#l00049">uavobjectutilmanager.h:49</a></div></div>
<div class="ttc" id="group___uploader_html_gaa726ecf0db7424f9980ac006267b6bbd"><div class="ttname"><a href="group___uploader.html#gaa726ecf0db7424f9980ac006267b6bbd">tl_dfu::device::HW_Rev</a></div><div class="ttdeci">int HW_Rev</div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00072">tl_dfu.h:72</a></div></div>
<div class="ttc" id="group___uploader_html_gga5668196b7ff4028f1f71803e9ff5c7c4a9e44395ad4ded84b53a90b8664d86947"><div class="ttname"><a href="group___uploader.html#gga5668196b7ff4028f1f71803e9ff5c7c4a9e44395ad4ded84b53a90b8664d86947">tl_dfu::Last_operation_Success</a></div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00050">tl_dfu.h:50</a></div></div>
<div class="ttc" id="group___u_a_v_objects_plugin_html_ga2aa3a13d1eb39329f28842887c6d7db6"><div class="ttname"><a href="group___u_a_v_objects_plugin.html#ga2aa3a13d1eb39329f28842887c6d7db6">UAVObjectUtilManager::getFirmwareCRC</a></div><div class="ttdeci">quint32 getFirmwareCRC()</div><div class="ttdef"><b>Definition:</b> <a href="uavobjectutilmanager_8cpp_source.html#l00536">uavobjectutilmanager.cpp:536</a></div></div>
<div class="ttc" id="group___uploader_html_gga5668196b7ff4028f1f71803e9ff5c7c4a563943e44f2724d6fd4f42d093712350"><div class="ttname"><a href="group___uploader.html#gga5668196b7ff4028f1f71803e9ff5c7c4a563943e44f2724d6fd4f42d093712350">tl_dfu::DFUidle</a></div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00045">tl_dfu.h:45</a></div></div>
<div class="ttc" id="group___raw_h_i_d_plugin_html_ggaff6bf8945a7cdab907cf5adc29bec064ac18f9b621b18e8d33c36467a92dd0dc9"><div class="ttname"><a href="group___raw_h_i_d_plugin.html#ggaff6bf8945a7cdab907cf5adc29bec064ac18f9b621b18e8d33c36467a92dd0dc9">USBMonitor::Bootloader</a></div><div class="ttdef"><b>Definition:</b> <a href="usbmonitor_8h_source.html#l00091">usbmonitor.h:91</a></div></div>
<div class="ttc" id="group___uploader_html_ga9a0bf1af93f4208e065382a88dda1b58"><div class="ttname"><a href="group___uploader.html#ga9a0bf1af93f4208e065382a88dda1b58">uploader::UploaderGadgetWidget::UploaderGadgetWidget</a></div><div class="ttdeci">UploaderGadgetWidget(QWidget *parent=nullptr)</div><div class="ttdoc">Class constructor, sets signal to slot connections, creates actions, creates utility classes instance...</div><div class="ttdef"><b>Definition:</b> <a href="uploadergadgetwidget_8cpp_source.html#l00058">uploadergadgetwidget.cpp:58</a></div></div>
<div class="ttc" id="group___u_a_v_objects_plugin_html_ga31c6b739ad7f06472a3f3386e4bebd8a"><div class="ttname"><a href="group___u_a_v_objects_plugin.html#ga31c6b739ad7f06472a3f3386e4bebd8a">UAVObjectUtilManager::descriptionToStructure</a></div><div class="ttdeci">static bool descriptionToStructure(QByteArray desc, deviceDescriptorStruct &amp;struc)</div><div class="ttdef"><b>Definition:</b> <a href="uavobjectutilmanager_8cpp_source.html#l00667">uavobjectutilmanager.cpp:667</a></div></div>
<div class="ttc" id="group___uploader_html_gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4"><div class="ttname"><a href="group___uploader.html#gga769c7820b34912a5b82a8d29aa47308dab33439d514d09fbf0133fc46a6fc07f4">uploader::STATUSICON_INFO</a></div><div class="ttdef"><b>Definition:</b> <a href="uploadergadgetwidget_8h_source.html#l00053">uploadergadgetwidget.h:53</a></div></div>
<div class="ttc" id="group___core_plugin_html_ga01532acba71e5af5bee3777209aebf7d"><div class="ttname"><a href="group___core_plugin.html#ga01532acba71e5af5bee3777209aebf7d">Core::ICore::boardManager</a></div><div class="ttdeci">virtual BoardManager * boardManager() const =0</div></div>
<div class="ttc" id="group___core_plugin_html_ga8c20a34ba137f0263f3d5d17e8193d24"><div class="ttname"><a href="group___core_plugin.html#ga8c20a34ba137f0263f3d5d17e8193d24">Core::BoardManager::getBoard</a></div><div class="ttdeci">IBoardType * getBoard(int type)</div><div class="ttdoc">Find a board from it&#39;s type. </div><div class="ttdef"><b>Definition:</b> <a href="boardmanager_8cpp_source.html#l00118">boardmanager.cpp:118</a></div></div>
<div class="ttc" id="group___uploader_html_gga7a55292dbba91b1d8a44bc6b127997feafc3a3c77089a4480a5c6b4e6a69d70a2"><div class="ttname"><a href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feafc3a3c77089a4480a5c6b4e6a69d70a2">tl_dfu::DFU_PARTITION_LOG</a></div><div class="ttdef"><b>Definition:</b> <a href="bl__messages_8h_source.html#l00102">bl_messages.h:102</a></div></div>
<div class="ttc" id="group___raw_h_i_d_plugin_html_ga8e42cdaa700116a4467d8ded1f506ed9"><div class="ttname"><a href="group___raw_h_i_d_plugin.html#ga8e42cdaa700116a4467d8ded1f506ed9">USBSignalFilter::deviceRemoved</a></div><div class="ttdeci">void deviceRemoved()</div></div>
<div class="ttc" id="group___uploader_html_ga87d448f5964c57b1342f16f75bedc721"><div class="ttname"><a href="group___uploader.html#ga87d448f5964c57b1342f16f75bedc721">uploader::UploaderGadgetWidget::enteredLoader</a></div><div class="ttdeci">void enteredLoader()</div></div>
<div class="ttc" id="group___core_plugin_html_ga6978a5ac87f3d9dcd891f1be551d3b87"><div class="ttname"><a href="group___core_plugin.html#ga6978a5ac87f3d9dcd891f1be551d3b87">Core::Constants::GCS_REVISION_STR</a></div><div class="ttdeci">const char *const GCS_REVISION_STR</div><div class="ttdef"><b>Definition:</b> <a href="coreconstants_8h_source.html#l00045">coreconstants.h:45</a></div></div>
<div class="ttc" id="group___raw_h_i_d_plugin_html_gabcb44085db71f0bd0a1513d25a572b33"><div class="ttname"><a href="group___raw_h_i_d_plugin.html#gabcb44085db71f0bd0a1513d25a572b33">USBMonitor::instance</a></div><div class="ttdeci">static USBMonitor * instance()</div><div class="ttdef"><b>Definition:</b> <a href="usbmonitor_8cpp_source.html#l00176">usbmonitor.cpp:176</a></div></div>
<div class="ttc" id="group___uploader_html_gga77a98a88ccfc2d6f0236ec9e053da638ab6ba6c9dae0eb16c08ccfe66e1005a0e"><div class="ttname"><a href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638ab6ba6c9dae0eb16c08ccfe66e1005a0e">UpgradeAssistantDialog::STEP_TRANSLATESETTINGS</a></div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00052">upgradeassistantdialog.h:52</a></div></div>
<div class="ttc" id="group___core_plugin_html_ga90db60736480bb690e6ec029acbce4d1"><div class="ttname"><a href="group___core_plugin.html#ga90db60736480bb690e6ec029acbce4d1">Core::DevListItem::connection</a></div><div class="ttdeci">IConnection * connection</div><div class="ttdef"><b>Definition:</b> <a href="connectionmanager_8h_source.html#l00096">connectionmanager.h:96</a></div></div>
<div class="ttc" id="group___u_a_v_object_util_plugin_html_gaf7688dd9b2d5fe676da57bbca33e460d"><div class="ttname"><a href="group___u_a_v_object_util_plugin.html#gaf7688dd9b2d5fe676da57bbca33e460d">deviceDescriptorStruct::gitDate</a></div><div class="ttdeci">QString gitDate</div><div class="ttdef"><b>Definition:</b> <a href="devicedescriptorstruct_8h_source.html#l00038">devicedescriptorstruct.h:38</a></div></div>
<div class="ttc" id="class_core_1_1_action_manager_html"><div class="ttname"><a href="class_core_1_1_action_manager.html">Core::ActionManager</a></div><div class="ttdoc">The action manager is responsible for registration of menus and menu items and keyboard shortcuts...</div><div class="ttdef"><b>Definition:</b> <a href="actionmanager_8h_source.html#l00047">actionmanager.h:47</a></div></div>
<div class="ttc" id="group___uploader_html_gga77a98a88ccfc2d6f0236ec9e053da638a346336db514620881dffc585abb08657"><div class="ttname"><a href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a346336db514620881dffc585abb08657">UpgradeAssistantDialog::STEP_CHECKCLOUD</a></div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00049">upgradeassistantdialog.h:49</a></div></div>
<div class="ttc" id="group___uploader_html_ga5520e776ad3920f6a3cf5dbca46d9fb0"><div class="ttname"><a href="group___uploader.html#ga5520e776ad3920f6a3cf5dbca46d9fb0">tl_dfu::device::PartitionSizes</a></div><div class="ttdeci">QVector&lt; quint32 &gt; PartitionSizes</div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00071">tl_dfu.h:71</a></div></div>
<div class="ttc" id="structdevice_info_html_a647448a132fb029f6f4ab940ac71e8aa"><div class="ttname"><a href="structdevice_info.html#a647448a132fb029f6f4ab940ac71e8aa">deviceInfo::board</a></div><div class="ttdeci">QPointer&lt; Core::IBoardType &gt; board</div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00048">uploader_global.h:48</a></div></div>
<div class="ttc" id="class_u_a_v_object_manager_html"><div class="ttname"><a href="class_u_a_v_object_manager.html">UAVObjectManager</a></div><div class="ttdef"><b>Definition:</b> <a href="uavobjectmanager_8h_source.html#l00046">uavobjectmanager.h:46</a></div></div>
<div class="ttc" id="group___u_a_v_talk_plugin_html_ga54bec8ecfe469710c7261f567e76c5f0"><div class="ttname"><a href="group___u_a_v_talk_plugin.html#ga54bec8ecfe469710c7261f567e76c5f0">TelemetryManager::connected</a></div><div class="ttdeci">void connected()</div></div>
<div class="ttc" id="namespaceuploader_html_aae5cd9d9abc36fb9bb59f55a29f5f690a6f34924bb42c3b036dedf26458bb370e"><div class="ttname"><a href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6f34924bb42c3b036dedf26458bb370e">uploader::CONNECTED_TO_TELEMETRY</a></div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00041">uploader_global.h:41</a></div></div>
<div class="ttc" id="group___core_plugin_html_gaddaeace95ea23949d99762156cf96a98"><div class="ttname"><a href="group___core_plugin.html#gaddaeace95ea23949d99762156cf96a98">Core::IBoardType::getBoardNameFromID</a></div><div class="ttdeci">static QString getBoardNameFromID(int id)</div><div class="ttdef"><b>Definition:</b> <a href="iboardtype_8cpp_source.html#l00075">iboardtype.cpp:75</a></div></div>
<div class="ttc" id="struct_u_s_b_port_info_html"><div class="ttname"><a href="struct_u_s_b_port_info.html">USBPortInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="usbmonitor_8h_source.html#l00042">usbmonitor.h:42</a></div></div>
<div class="ttc" id="group___u_a_v_talk_plugin_html_ga61e671949cc2403327617d9c9a372a76"><div class="ttname"><a href="group___u_a_v_talk_plugin.html#ga61e671949cc2403327617d9c9a372a76">TelemetryManager::disconnected</a></div><div class="ttdeci">void disconnected()</div></div>
<div class="ttc" id="group___u_a_v_objects_plugin_html_ga444cf2ff3f0ecbe028adce838d373f5c"><div class="ttname"><a href="group___u_a_v_objects_plugin.html#ga444cf2ff3f0ecbe028adce838d373f5c">void</a></div><div class="ttdeci">void(NAME)</div><div class="ttdef"><b>Definition:</b> <a href="uavobjecttemplate_8cpp_source.html#l00088">uavobjecttemplate.cpp:88</a></div></div>
<div class="ttc" id="group___uploader_html_gga7a55292dbba91b1d8a44bc6b127997fea6a3d4ee0f00e71f903a165e9fbb10c93"><div class="ttname"><a href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997fea6a3d4ee0f00e71f903a165e9fbb10c93">tl_dfu::DFU_PARTITION_DESC</a></div><div class="ttdef"><b>Definition:</b> <a href="bl__messages_8h_source.html#l00098">bl_messages.h:98</a></div></div>
<div class="ttc" id="classdevice_descriptor_struct_html"><div class="ttname"><a href="classdevice_descriptor_struct.html">deviceDescriptorStruct</a></div><div class="ttdef"><b>Definition:</b> <a href="devicedescriptorstruct_8h_source.html#l00034">devicedescriptorstruct.h:34</a></div></div>
<div class="ttc" id="class_q_list_html"><div class="ttname"><a href="class_q_list.html">QList</a></div><div class="ttdef"><b>Definition:</b> <a href="icore_8h_source.html#l00039">icore.h:39</a></div></div>
<div class="ttc" id="group___uploader_html_gga7a55292dbba91b1d8a44bc6b127997feaee07f6612e39b0d73a7314fe713e43e3"><div class="ttname"><a href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feaee07f6612e39b0d73a7314fe713e43e3">tl_dfu::DFU_PARTITION_SETTINGS</a></div><div class="ttdef"><b>Definition:</b> <a href="bl__messages_8h_source.html#l00100">bl_messages.h:100</a></div></div>
<div class="ttc" id="structdevice_info_html_ac8171c63846102b491a666633b80aea4"><div class="ttname"><a href="structdevice_info.html#ac8171c63846102b491a666633b80aea4">deviceInfo::hw_revision</a></div><div class="ttdeci">QString hw_revision</div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00052">uploader_global.h:52</a></div></div>
<div class="ttc" id="group___uploader_html_gga7a55292dbba91b1d8a44bc6b127997feadac570fef1060ba6fb6c2f7f9a0ba23c"><div class="ttname"><a href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997feadac570fef1060ba6fb6c2f7f9a0ba23c">tl_dfu::DFU_PARTITION_LOADABLE_EXTENSION</a></div><div class="ttdef"><b>Definition:</b> <a href="bl__messages_8h_source.html#l00103">bl_messages.h:103</a></div></div>
<div class="ttc" id="group___u_a_v_object_util_plugin_html_ga49289a9802c5eec2cc8b0b38c7c88500"><div class="ttname"><a href="group___u_a_v_object_util_plugin.html#ga49289a9802c5eec2cc8b0b38c7c88500">deviceDescriptorStruct::certified</a></div><div class="ttdeci">bool certified</div><div class="ttdef"><b>Definition:</b> <a href="devicedescriptorstruct_8h_source.html#l00049">devicedescriptorstruct.h:49</a></div></div>
<div class="ttc" id="namespaceuploader_html_aae5cd9d9abc36fb9bb59f55a29f5f690a6490cdc12cc97adfcc89f39adda55807"><div class="ttname"><a href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a6490cdc12cc97adfcc89f39adda55807">uploader::ENTERING_LOADER</a></div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00038">uploader_global.h:38</a></div></div>
<div class="ttc" id="group___raw_h_i_d_plugin_html_ga9d88c3bd1d000b31ad72af4735edaaf2"><div class="ttname"><a href="group___raw_h_i_d_plugin.html#ga9d88c3bd1d000b31ad72af4735edaaf2">USBSignalFilter::deviceDiscovered</a></div><div class="ttdeci">void deviceDiscovered()</div></div>
<div class="ttc" id="namespaceuploader_html_aae5cd9d9abc36fb9bb59f55a29f5f690a9068a448064dd9c673d038228a0531da"><div class="ttname"><a href="namespaceuploader.html#aae5cd9d9abc36fb9bb59f55a29f5f690a9068a448064dd9c673d038228a0531da">uploader::UPGRADING_CATCHLOADER</a></div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00043">uploader_global.h:43</a></div></div>
<div class="ttc" id="modemanager_8h_html"><div class="ttname"><a href="modemanager_8h.html">modemanager.h</a></div></div>
<div class="ttc" id="group___raw_h_i_d_plugin_html_gab6d916c34dedc4292a96af9d8abde7ea"><div class="ttname"><a href="group___raw_h_i_d_plugin.html#gab6d916c34dedc4292a96af9d8abde7ea">USBPortInfo::getRunState</a></div><div class="ttdeci">unsigned char getRunState()</div><div class="ttdef"><b>Definition:</b> <a href="usbmonitor_8h_source.html#l00054">usbmonitor.h:54</a></div></div>
<div class="ttc" id="group___uploader_html_gga77a98a88ccfc2d6f0236ec9e053da638a46a023cecebac11a9cae261d09c1d882"><div class="ttname"><a href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a46a023cecebac11a9cae261d09c1d882">UpgradeAssistantDialog::STEP_FLASHFIRMWARE</a></div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00054">upgradeassistantdialog.h:54</a></div></div>
<div class="ttc" id="group___uploader_html_ga6dfbf5113f62a7d7f7c71c618744ea0d"><div class="ttname"><a href="group___uploader.html#ga6dfbf5113f62a7d7f7c71c618744ea0d">tl_dfu::device::ID</a></div><div class="ttdeci">quint16 ID</div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00064">tl_dfu.h:64</a></div></div>
<div class="ttc" id="group___u_a_v_objects_plugin_html_gab0eb14551119e370daee5cf188961831"><div class="ttname"><a href="group___u_a_v_objects_plugin.html#gab0eb14551119e370daee5cf188961831">UAVObjectUtilManager::getBoardDescriptionStruct</a></div><div class="ttdeci">bool getBoardDescriptionStruct(deviceDescriptorStruct &amp;device)</div><div class="ttdef"><b>Definition:</b> <a href="uavobjectutilmanager_8cpp_source.html#l00661">uavobjectutilmanager.cpp:661</a></div></div>
<div class="ttc" id="group___u_a_v_objects_plugin_html_gac3a1293716fa3eb310ed257ade7f6722"><div class="ttname"><a href="group___u_a_v_objects_plugin.html#gac3a1293716fa3eb310ed257ade7f6722">UAVObjectUtilManager::getBoardType</a></div><div class="ttdeci">Core::IBoardType * getBoardType()</div><div class="ttdoc">Get the IBoardType corresponding to the connected board. </div><div class="ttdef"><b>Definition:</b> <a href="uavobjectutilmanager_8cpp_source.html#l00511">uavobjectutilmanager.cpp:511</a></div></div>
<div class="ttc" id="group___uploader_html_ga245cc1bb639b28a773705eb968b6b770"><div class="ttname"><a href="group___uploader.html#ga245cc1bb639b28a773705eb968b6b770">UpgradeAssistantDialog::onStepChanged</a></div><div class="ttdeci">void onStepChanged(UpgradeAssistantStep step)</div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8cpp_source.html#l00123">upgradeassistantdialog.cpp:123</a></div></div>
<div class="ttc" id="group___core_plugin_html_gad436df0a83378128cb8034d83e6734f0"><div class="ttname"><a href="group___core_plugin.html#gad436df0a83378128cb8034d83e6734f0">Core::IConnection::shortName</a></div><div class="ttdeci">virtual QString shortName()</div><div class="ttdef"><b>Definition:</b> <a href="iconnection_8h_source.html#l00071">iconnection.h:71</a></div></div>
<div class="ttc" id="group___uploader_html_gga7a55292dbba91b1d8a44bc6b127997fea5722b7b547679e553019b9c3ec8a4d41"><div class="ttname"><a href="group___uploader.html#gga7a55292dbba91b1d8a44bc6b127997fea5722b7b547679e553019b9c3ec8a4d41">tl_dfu::DFU_PARTITION_BL</a></div><div class="ttdef"><b>Definition:</b> <a href="bl__messages_8h_source.html#l00099">bl_messages.h:99</a></div></div>
<div class="ttc" id="class_u_s_b_signal_filter_html"><div class="ttname"><a href="class_u_s_b_signal_filter.html">USBSignalFilter</a></div><div class="ttdef"><b>Definition:</b> <a href="usbsignalfilter_8h_source.html#l00037">usbsignalfilter.h:37</a></div></div>
<div class="ttc" id="group___u_a_v_object_util_plugin_html_ga11c8171d7e380e699b4edf9b6860a236"><div class="ttname"><a href="group___u_a_v_object_util_plugin.html#ga11c8171d7e380e699b4edf9b6860a236">UAVObjectUtilManager::getBoardCPUSerial</a></div><div class="ttdeci">QByteArray getBoardCPUSerial()</div><div class="ttdef"><b>Definition:</b> <a href="uavobjectutilmanager_8cpp_source.html#l00525">uavobjectutilmanager.cpp:525</a></div></div>
<div class="ttc" id="uavobjecttemplate_8m_html_a6a3730e10b2455e9a8b6599785809fce"><div class="ttname"><a href="uavobjecttemplate_8m.html#a6a3730e10b2455e9a8b6599785809fce">crc</a></div><div class="ttdeci">function crc</div><div class="ttdef"><b>Definition:</b> <a href="uavobjecttemplate_8m_source.html#l00332">uavobjecttemplate.m:332</a></div></div>
<div class="ttc" id="group___core_plugin_html_gad4e7e06b9cc1c4720a0bb9202c5dca19"><div class="ttname"><a href="group___core_plugin.html#gad4e7e06b9cc1c4720a0bb9202c5dca19">Core::ConnectionManager::suspendPolling</a></div><div class="ttdeci">void suspendPolling()</div><div class="ttdef"><b>Definition:</b> <a href="connectionmanager_8cpp_source.html#l00368">connectionmanager.cpp:368</a></div></div>
<div class="ttc" id="class_core_1_1_command_html"><div class="ttname"><a href="class_core_1_1_command.html">Core::Command</a></div><div class="ttdoc">The class Command represents an action like a menu item, tool button, or shortcut. You don&#39;t create Command objects directly, instead use {ActionManager::registerAction()} to register an action and retrieve a Command. The Command object represents the user visible action and its properties. If multiple actions are registered with the same ID (but different contexts) the returned Command is the shared one between these actions. </div><div class="ttdef"><b>Definition:</b> <a href="command_8h_source.html#l00043">command.h:43</a></div></div>
<div class="ttc" id="uploadergadgetwidget_8h_html"><div class="ttname"><a href="uploadergadgetwidget_8h.html">uploadergadgetwidget.h</a></div></div>
<div class="ttc" id="group___uploader_html_gga77a98a88ccfc2d6f0236ec9e053da638a8e29c859eaa872af281c27107856fbae"><div class="ttname"><a href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638a8e29c859eaa872af281c27107856fbae">UpgradeAssistantDialog::STEP_ERASESETTINGS</a></div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00053">upgradeassistantdialog.h:53</a></div></div>
<div class="ttc" id="group___u_a_v_object_util_plugin_html_ga48e724f021e815c98e2143dd6df1695b"><div class="ttname"><a href="group___u_a_v_object_util_plugin.html#ga48e724f021e815c98e2143dd6df1695b">deviceDescriptorStruct::userDefined</a></div><div class="ttdeci">QString userDefined</div><div class="ttdef"><b>Definition:</b> <a href="devicedescriptorstruct_8h_source.html#l00040">devicedescriptorstruct.h:40</a></div></div>
<div class="ttc" id="group___core_plugin_html_gaffc78d62ba1226c3d690158e30db4dee"><div class="ttname"><a href="group___core_plugin.html#gaffc78d62ba1226c3d690158e30db4dee">Core::ConnectionManager::resumePolling</a></div><div class="ttdeci">void resumePolling()</div><div class="ttdef"><b>Definition:</b> <a href="connectionmanager_8cpp_source.html#l00383">connectionmanager.cpp:383</a></div></div>
<div class="ttc" id="coreconstants_8h_html"><div class="ttname"><a href="coreconstants_8h.html">coreconstants.h</a></div></div>
<div class="ttc" id="group___u_a_v_objects_plugin_html_ga20e8da6668f3dfb1231b33e7b44af01c"><div class="ttname"><a href="group___u_a_v_objects_plugin.html#ga20e8da6668f3dfb1231b33e7b44af01c">UAVObjectUtilManager::getBoardRevision</a></div><div class="ttdeci">int getBoardRevision()</div><div class="ttdoc">Get the connected board hardware revision. </div><div class="ttdef"><b>Definition:</b> <a href="uavobjectutilmanager_8cpp_source.html#l00503">uavobjectutilmanager.cpp:503</a></div></div>
<div class="ttc" id="group___u_a_v_talk_plugin_html_ga753148204d39c087c9aa27c9dbe9df98"><div class="ttname"><a href="group___u_a_v_talk_plugin.html#ga753148204d39c087c9aa27c9dbe9df98">TelemetryManager::isConnected</a></div><div class="ttdeci">bool isConnected() const </div><div class="ttdef"><b>Definition:</b> <a href="telemetrymanager_8h_source.html#l00052">telemetrymanager.h:52</a></div></div>
<div class="ttc" id="structtl__dfu_1_1device_html"><div class="ttname"><a href="structtl__dfu_1_1device.html">tl_dfu::device</a></div><div class="ttdef"><b>Definition:</b> <a href="tl__dfu_8h_source.html#l00062">tl_dfu.h:62</a></div></div>
<div class="ttc" id="structdevice_info_html_a4c7f3d6cd35d1cd5f8756075d915d704"><div class="ttname"><a href="structdevice_info.html#a4c7f3d6cd35d1cd5f8756075d915d704">deviceInfo::cpu_serial</a></div><div class="ttdeci">QString cpu_serial</div><div class="ttdef"><b>Definition:</b> <a href="uploader__global_8h_source.html#l00051">uploader_global.h:51</a></div></div>
<div class="ttc" id="group___uploader_html_gga77a98a88ccfc2d6f0236ec9e053da638ae5a335d0c9f77d5e549b8fb85921f313"><div class="ttname"><a href="group___uploader.html#gga77a98a88ccfc2d6f0236ec9e053da638ae5a335d0c9f77d5e549b8fb85921f313">UpgradeAssistantDialog::STEP_ENTERLOADER</a></div><div class="ttdef"><b>Definition:</b> <a href="upgradeassistantdialog_8h_source.html#l00048">upgradeassistantdialog.h:48</a></div></div>
<div class="ttc" id="group___u_a_v_object_util_plugin_html_ga7c265729bc1bc959e63a3c8f0f1543e8"><div class="ttname"><a href="group___u_a_v_object_util_plugin.html#ga7c265729bc1bc959e63a3c8f0f1543e8">deviceDescriptorStruct::gitHash</a></div><div class="ttdeci">QString gitHash</div><div class="ttdef"><b>Definition:</b> <a href="devicedescriptorstruct_8h_source.html#l00037">devicedescriptorstruct.h:37</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_bb77b04ae0ff98f0a5dcf95af99976f7.html">ground</a></li><li class="navelem"><a class="el" href="dir_4914b6d078edd15de416a0588b1408c9.html">gcs</a></li><li class="navelem"><a class="el" href="dir_979cc242bcdb61c8fecc823ca107a4ab.html">src</a></li><li class="navelem"><a class="el" href="dir_8b22256ffc0f161b5ef261c0476f6e8f.html">plugins</a></li><li class="navelem"><a class="el" href="dir_29a771fce101f638f12b49f60f514857.html">uploader</a></li><li class="navelem"><a class="el" href="uploadergadgetwidget_8cpp.html">uploadergadgetwidget.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
